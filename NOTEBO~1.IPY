{"cells":[{"source":"# **Unicorn Companies Analysis: Industry Trends & Investment Insights**","metadata":{},"cell_type":"markdown","id":"eb29d610-82cc-49f1-afd3-21a69bee523d"},{"source":"Did you know that the average return from investing in stocks is [10% per year](https://www.nerdwallet.com/article/investing/average-stock-market-return) (not accounting for inflation)? But who wants to be average?! \n\nYou have been asked to support an investment firm by analyzing trends in high-growth companies. They are interested in understanding which industries are producing the highest valuations and the rate at which new high-value companies are emerging. Providing them with this information gives them a competitive insight as to industry trends and how they should structure their portfolio looking forward.\n\nYou have been given access to their `unicorns` database, which contains the following tables:\n\n## dates\n| Column       | Description                                  |\n|------------- |--------------------------------------------- |\n| `company_id`   | A unique ID for the company.                 |\n| `date_joined` | The date that the company became a unicorn.  |\n| `year_founded` | The year that the company was founded.       |\n\n## funding\n| Column           | Description                                  |\n|----------------- |--------------------------------------------- |\n| `company_id`       | A unique ID for the company.                 |\n| `valuation`        | Company value in US dollars.                 |\n| `funding`          | The amount of funding raised in US dollars.  |\n| `select_investors` | A list of key investors in the company.      |\n\n## industries\n| Column       | Description                                  |\n|------------- |--------------------------------------------- |\n| `company_id`   | A unique ID for the company.                 |\n| `industry`     | The industry that the company operates in.   |\n\n## companies\n| Column       | Description                                       |\n|------------- |-------------------------------------------------- |\n| `company_id`   | A unique ID for the company.                      |\n| `company`      | The name of the company.                          |\n| `city`         | The city where the company is headquartered.      |\n| `country`      | The country where the company is headquartered.   |\n| `continent`    | The continent where the company is headquartered. |\n","metadata":{},"id":"33dda299-ad0e-4262-b285-7d1297a3ba66","cell_type":"markdown"},{"source":"# **Data Validation and Initial Exploration**","metadata":{},"cell_type":"markdown","id":"c25e63a9-4c81-4246-8c68-d9accc706ebb"},{"source":"-- review the structure of all required tables.\n\nSELECT table_name, column_name, data_type\nFROM information_schema.columns\nWHERE table_name IN ('dates', 'funding', 'industries', 'companies')\nORDER BY table_name, ordinal_position;","metadata":{"customType":"sql","dataFrameVariableName":"data_types","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1160,"lastExecutedAt":1767706430027,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- review the structure of all required tables.\n\nSELECT table_name, column_name, data_type\nFROM information_schema.columns\nWHERE table_name IN ('dates', 'funding', 'industries', 'companies')\nORDER BY table_name, ordinal_position;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"0a6fedea-f782-4dd4-b145-6dbb30cef423","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"table_name","type":"string"},{"name":"column_name","type":"string"},{"name":"data_type","type":"string"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"table_name":["companies","companies","companies","companies","companies","dates","dates","dates","funding","funding","funding","funding","industries","industries"],"column_name":["company_id","company","city","country","continent","company_id","date_joined","year_founded","company_id","valuation","funding","select_investors","company_id","industry"],"data_type":["integer","character varying","character varying","character varying","character varying","integer","date","integer","integer","bigint","bigint","character varying","integer","character varying"]}},"total_rows":14,"truncation_type":null},"text/plain":"    table_name       column_name          data_type\n0    companies        company_id            integer\n1    companies           company  character varying\n2    companies              city  character varying\n3    companies           country  character varying\n4    companies         continent  character varying\n5        dates        company_id            integer\n6        dates       date_joined               date\n7        dates      year_founded            integer\n8      funding        company_id            integer\n9      funding         valuation             bigint\n10     funding           funding             bigint\n11     funding  select_investors  character varying\n12  industries        company_id            integer\n13  industries          industry  character varying","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>table_name</th>\n      <th>column_name</th>\n      <th>data_type</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>companies</td>\n      <td>company_id</td>\n      <td>integer</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>companies</td>\n      <td>company</td>\n      <td>character varying</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>companies</td>\n      <td>city</td>\n      <td>character varying</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>companies</td>\n      <td>country</td>\n      <td>character varying</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>companies</td>\n      <td>continent</td>\n      <td>character varying</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>dates</td>\n      <td>company_id</td>\n      <td>integer</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>dates</td>\n      <td>date_joined</td>\n      <td>date</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>dates</td>\n      <td>year_founded</td>\n      <td>integer</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>funding</td>\n      <td>company_id</td>\n      <td>integer</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>funding</td>\n      <td>valuation</td>\n      <td>bigint</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>funding</td>\n      <td>funding</td>\n      <td>bigint</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>funding</td>\n      <td>select_investors</td>\n      <td>character varying</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>industries</td>\n      <td>company_id</td>\n      <td>integer</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>industries</td>\n      <td>industry</td>\n      <td>character varying</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":51,"@datacamp/metadata":{"executedQuery":"-- review the structure of all required tables.\n\nSELECT table_name, column_name, data_type\nFROM information_schema.columns\nWHERE table_name IN ('dates', 'funding', 'industries', 'companies')\nORDER BY table_name, ordinal_position;","executedQueryParameters":[]}}],"execution_count":51},{"source":"--- Overview of table dates\n\nSELECT *\nFROM dates\nLIMIT 5;","metadata":{"customType":"sql","dataFrameVariableName":"dates","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1129,"lastExecutedAt":1767706431156,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Overview of table dates\n\nSELECT *\nFROM dates\nLIMIT 5;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"1387e6de-4444-4bff-83ac-5291d20da1e4","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"company_id","type":"integer"},{"name":"date_joined","type":"datetime","tz":"UTC"},{"name":"year_founded","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4],"company_id":[189,848,556,999,396],"date_joined":["2017-06-24T00:00:00.000","2021-06-01T00:00:00.000","2022-02-15T00:00:00.000","2021-11-17T00:00:00.000","2021-10-21T00:00:00.000"],"year_founded":[1919,2019,2011,2020,2021]}},"total_rows":5,"truncation_type":null},"text/plain":"   company_id               date_joined  year_founded\n0         189 2017-06-24 00:00:00+00:00          1919\n1         848 2021-06-01 00:00:00+00:00          2019\n2         556 2022-02-15 00:00:00+00:00          2011\n3         999 2021-11-17 00:00:00+00:00          2020\n4         396 2021-10-21 00:00:00+00:00          2021","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>company_id</th>\n      <th>date_joined</th>\n      <th>year_founded</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>189</td>\n      <td>2017-06-24 00:00:00+00:00</td>\n      <td>1919</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>848</td>\n      <td>2021-06-01 00:00:00+00:00</td>\n      <td>2019</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>556</td>\n      <td>2022-02-15 00:00:00+00:00</td>\n      <td>2011</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>999</td>\n      <td>2021-11-17 00:00:00+00:00</td>\n      <td>2020</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>396</td>\n      <td>2021-10-21 00:00:00+00:00</td>\n      <td>2021</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":52,"@datacamp/metadata":{"executedQuery":"--- Overview of table dates\n\nSELECT *\nFROM dates\nLIMIT 5;","executedQueryParameters":[]}}],"execution_count":52},{"source":"--- Overview of table funding\n\nSELECT *\nFROM funding\nLIMIT 5;","metadata":{"customType":"sql","dataFrameVariableName":"funding","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"f6a39721-5ee2-42c5-96a1-bb203059c268","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"company_id","type":"integer"},{"name":"valuation","type":"integer"},{"name":"funding","type":"integer"},{"name":"select_investors","type":"string"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4],"company_id":[189,848,556,999,396],"valuation":[4000000000,1000000000,2000000000,1000000000,2000000000],"funding":[0,100000000,100000000,100000000,100000000],"select_investors":["EQT Partners","Dragonfly Captial, Qiming Venture Partners, DST Global","Blackstone, Bessemer Venture Partners","Goldman Sachs Asset Management, 3L","Insight Partners, Softbank Group, Connect Ventures"]}},"total_rows":5,"truncation_type":null},"text/plain":"   company_id  ...                                   select_investors\n0         189  ...                                       EQT Partners\n1         848  ...  Dragonfly Captial, Qiming Venture Partners, DS...\n2         556  ...              Blackstone, Bessemer Venture Partners\n3         999  ...                 Goldman Sachs Asset Management, 3L\n4         396  ...  Insight Partners, Softbank Group, Connect Vent...\n\n[5 rows x 4 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>company_id</th>\n      <th>valuation</th>\n      <th>funding</th>\n      <th>select_investors</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>189</td>\n      <td>4000000000</td>\n      <td>0</td>\n      <td>EQT Partners</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>848</td>\n      <td>1000000000</td>\n      <td>100000000</td>\n      <td>Dragonfly Captial, Qiming Venture Partners, DS...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>556</td>\n      <td>2000000000</td>\n      <td>100000000</td>\n      <td>Blackstone, Bessemer Venture Partners</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>999</td>\n      <td>1000000000</td>\n      <td>100000000</td>\n      <td>Goldman Sachs Asset Management, 3L</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>396</td>\n      <td>2000000000</td>\n      <td>100000000</td>\n      <td>Insight Partners, Softbank Group, Connect Vent...</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":53,"@datacamp/metadata":{"executedQuery":"--- Overview of table funding\n\nSELECT *\nFROM funding\nLIMIT 5;","executedQueryParameters":[]}}],"execution_count":53},{"source":"--- Overview of table industries\n\nSELECT *\nFROM industries\nLIMIT 5;","metadata":{"customType":"sql","dataFrameVariableName":"industries","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1618,"lastExecutedAt":1767706434006,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Overview of table industries\n\nSELECT *\nFROM industries\nLIMIT 5;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"21905a56-232d-4e43-b7d5-b81c8884722a","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"company_id","type":"integer"},{"name":"industry","type":"string"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4],"company_id":[189,848,556,999,396],"industry":["Health","Fintech","Internet software & services","Internet software & services","Fintech"]}},"total_rows":5,"truncation_type":null},"text/plain":"   company_id                      industry\n0         189                        Health\n1         848                       Fintech\n2         556  Internet software & services\n3         999  Internet software & services\n4         396                       Fintech","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>company_id</th>\n      <th>industry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>189</td>\n      <td>Health</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>848</td>\n      <td>Fintech</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>556</td>\n      <td>Internet software &amp; services</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>999</td>\n      <td>Internet software &amp; services</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>396</td>\n      <td>Fintech</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":54,"@datacamp/metadata":{"executedQuery":"--- Overview of table industries\n\nSELECT *\nFROM industries\nLIMIT 5;","executedQueryParameters":[]}}],"execution_count":54},{"source":"--- Overview of table companies\n\nSELECT *\nFROM companies\nLIMIT 5;","metadata":{"customType":"sql","dataFrameVariableName":"companies","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1140,"lastExecutedAt":1767706435146,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Overview of table companies\n\nSELECT *\nFROM companies\nLIMIT 5;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"032dad87-1578-4e7a-bc1f-3c7844a847b1","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"company_id","type":"integer"},{"name":"company","type":"string"},{"name":"city","type":"string"},{"name":"country","type":"string"},{"name":"continent","type":"string"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4],"company_id":[189,848,556,999,396],"company":["Otto Bock HealthCare","Matrixport","Cloudinary","PLACE","candy.com"],"city":["Duderstadt","","Santa Clara","Bellingham","New York"],"country":["Germany","Singapore","United States","United States","United States"],"continent":["Europe","Asia","North America","North America","North America"]}},"total_rows":5,"truncation_type":null},"text/plain":"   company_id               company         city        country      continent\n0         189  Otto Bock HealthCare   Duderstadt        Germany         Europe\n1         848            Matrixport                   Singapore           Asia\n2         556            Cloudinary  Santa Clara  United States  North America\n3         999                 PLACE   Bellingham  United States  North America\n4         396             candy.com     New York  United States  North America","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>company_id</th>\n      <th>company</th>\n      <th>city</th>\n      <th>country</th>\n      <th>continent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>189</td>\n      <td>Otto Bock HealthCare</td>\n      <td>Duderstadt</td>\n      <td>Germany</td>\n      <td>Europe</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>848</td>\n      <td>Matrixport</td>\n      <td></td>\n      <td>Singapore</td>\n      <td>Asia</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>556</td>\n      <td>Cloudinary</td>\n      <td>Santa Clara</td>\n      <td>United States</td>\n      <td>North America</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>999</td>\n      <td>PLACE</td>\n      <td>Bellingham</td>\n      <td>United States</td>\n      <td>North America</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>396</td>\n      <td>candy.com</td>\n      <td>New York</td>\n      <td>United States</td>\n      <td>North America</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":55,"@datacamp/metadata":{"executedQuery":"--- Overview of table companies\n\nSELECT *\nFROM companies\nLIMIT 5;","executedQueryParameters":[]}}],"execution_count":55},{"source":"--- Checks the minimum and maximum values for date_joined and year_founded.\n\nSELECT \n\tMIN(date_joined) AS min_date_joined, \n\tMAX(date_joined) AS max_date_joined,\n\tMIN(year_founded) AS min_year_founded, \n\tMAX(year_founded) AS max_year_founded\nFROM dates;","metadata":{"customType":"sql","dataFrameVariableName":"date_joined_year_founded","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1466,"lastExecutedAt":1767706436612,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Checks the minimum and maximum values for date_joined and year_founded.\n\nSELECT \n\tMIN(date_joined) AS min_date_joined, \n\tMAX(date_joined) AS max_date_joined,\n\tMIN(year_founded) AS min_year_founded, \n\tMAX(year_founded) AS max_year_founded\nFROM dates;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"a56a5911-adae-4a0c-bf8e-33f6b17ce9fe","nodeType":"const"}}}}},"cell_type":"code","id":"83018260-52ed-4ae7-95cd-08a36c95c2e5","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"min_date_joined","type":"datetime","tz":"UTC"},{"name":"max_date_joined","type":"datetime","tz":"UTC"},{"name":"min_year_founded","type":"integer"},{"name":"max_year_founded","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0],"min_date_joined":["2007-07-02T00:00:00.000"],"max_date_joined":["2022-04-05T00:00:00.000"],"min_year_founded":[1919],"max_year_founded":[2021]}},"total_rows":1,"truncation_type":null},"text/plain":"            min_date_joined  ... max_year_founded\n0 2007-07-02 00:00:00+00:00  ...             2021\n\n[1 rows x 4 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>min_date_joined</th>\n      <th>max_date_joined</th>\n      <th>min_year_founded</th>\n      <th>max_year_founded</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2007-07-02 00:00:00+00:00</td>\n      <td>2022-04-05 00:00:00+00:00</td>\n      <td>1919</td>\n      <td>2021</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":56,"@datacamp/metadata":{"executedQuery":"--- Checks the minimum and maximum values for date_joined and year_founded.\n\nSELECT \n\tMIN(date_joined) AS min_date_joined, \n\tMAX(date_joined) AS max_date_joined,\n\tMIN(year_founded) AS min_year_founded, \n\tMAX(year_founded) AS max_year_founded\nFROM dates;","executedQueryParameters":[]}}],"execution_count":56},{"source":"--- Checks for missing values in key date-related fields.\n\nSELECT date_joined, year_founded\nFROM dates\nWHERE date_joined IS NULL \n\tAND year_founded IS NULL;","metadata":{"customType":"sql","dataFrameVariableName":"date_nulls","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1185,"lastExecutedAt":1767706437797,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Checks for missing values in key date-related fields.\n\nSELECT date_joined, year_founded\nFROM dates\nWHERE date_joined IS NULL \n\tAND year_founded IS NULL;","outputsMetadata":{"0":{"height":38,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"aaf72682-6830-4dc2-a091-55421e7e93cb","nodeType":"const"}}}}},"cell_type":"code","id":"12eeb83e-95ba-4a0f-8e33-d3ecc38f79a3","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"string"},{"name":"date_joined","type":"integer"},{"name":"year_founded","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[],"date_joined":[],"year_founded":[]}},"total_rows":0,"truncation_type":null},"text/plain":"Empty DataFrame\nColumns: [date_joined, year_founded]\nIndex: []","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date_joined</th>\n      <th>year_founded</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":57,"@datacamp/metadata":{"executedQuery":"--- Checks for missing values in key date-related fields.\n\nSELECT date_joined, year_founded\nFROM dates\nWHERE date_joined IS NULL \n\tAND year_founded IS NULL;","executedQueryParameters":[]}}],"execution_count":57},{"source":"--- Checks the minimum, maximum, and average values for valuation and funding.\n\nSELECT \n\tMIN(valuation) AS min_value, \n\tMAX(valuation) AS max_value, \n\tAVG(valuation) AS avg_value,\n\tMIN(funding) AS min_fund, \n\tMAX(funding) AS max_fund, \n\tAVG(funding) AS avg_fund\nFROM funding;","metadata":{"customType":"sql","dataFrameVariableName":"valuation_funding","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":141,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"}}}}},"cell_type":"code","id":"7163970a-3b54-45ae-9cc7-fbba59abb7b6","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"min_value","type":"integer"},{"name":"max_value","type":"integer"},{"name":"avg_value","type":"number"},{"name":"min_fund","type":"integer"},{"name":"max_fund","type":"integer"},{"name":"avg_fund","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0],"min_value":[1000000000],"max_value":[180000000000],"avg_value":[3455307262.5698323],"min_fund":[0],"max_fund":[14000000000],"avg_fund":[551042830.5400373]}},"total_rows":1,"truncation_type":null},"text/plain":"    min_value     max_value     avg_value  min_fund     max_fund      avg_fund\n0  1000000000  180000000000  3.455307e+09         0  14000000000  5.510428e+08","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>min_value</th>\n      <th>max_value</th>\n      <th>avg_value</th>\n      <th>min_fund</th>\n      <th>max_fund</th>\n      <th>avg_fund</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1000000000</td>\n      <td>180000000000</td>\n      <td>3.455307e+09</td>\n      <td>0</td>\n      <td>14000000000</td>\n      <td>5.510428e+08</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":58,"@datacamp/metadata":{"executedQuery":"--- Checks the minimum, maximum, and average values for valuation and funding.\n\nSELECT \n\tMIN(valuation) AS min_value, \n\tMAX(valuation) AS max_value, \n\tAVG(valuation) AS avg_value,\n\tMIN(funding) AS min_fund, \n\tMAX(funding) AS max_fund, \n\tAVG(funding) AS avg_fund\nFROM funding;","executedQueryParameters":[]}}],"execution_count":58},{"source":"--- Checks whether any records are missing valuation, funding, or investor information.\n\nSELECT valuation, funding\nFROM funding\nWHERE valuation IS NULL \n\tAND funding IS NULL\n\tAND select_investors IS NULL;","metadata":{"customType":"sql","dataFrameVariableName":"funding_nulls","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1176,"lastExecutedAt":1767706440163,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Checks whether any records are missing valuation, funding, or investor information.\n\nSELECT valuation, funding\nFROM funding\nWHERE valuation IS NULL \n\tAND funding IS NULL\n\tAND select_investors IS NULL;","outputsMetadata":{"0":{"height":38,"type":"dataFrame"}}},"cell_type":"code","id":"e342f646-a2c5-425d-86fb-ef73e6db54a3","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"string"},{"name":"valuation","type":"integer"},{"name":"funding","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[],"valuation":[],"funding":[]}},"total_rows":0,"truncation_type":null},"text/plain":"Empty DataFrame\nColumns: [valuation, funding]\nIndex: []","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>valuation</th>\n      <th>funding</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":59,"@datacamp/metadata":{"executedQuery":"--- Checks whether any records are missing valuation, funding, or investor information.\n\nSELECT valuation, funding\nFROM funding\nWHERE valuation IS NULL \n\tAND funding IS NULL\n\tAND select_investors IS NULL;","executedQueryParameters":[]}}],"execution_count":59},{"source":"--- Checks for missing industry classifications.\n\nSELECT industry\nFROM industries\nWHERE industry IS NULL;","metadata":{"customType":"sql","dataFrameVariableName":"industry_nulls","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1931,"lastExecutedAt":1767706442094,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Checks for missing industry classifications.\n\nSELECT industry\nFROM industries\nWHERE industry IS NULL;","outputsMetadata":{"0":{"height":38,"type":"dataFrame","tableState":{}}}},"cell_type":"code","id":"a71ee993-922e-41a4-b9db-db4eae204bda","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"string"},{"name":"industry","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[],"industry":[]}},"total_rows":0,"truncation_type":null},"text/plain":"Empty DataFrame\nColumns: [industry]\nIndex: []","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":60,"@datacamp/metadata":{"executedQuery":"--- Checks for missing industry classifications.\n\nSELECT industry\nFROM industries\nWHERE industry IS NULL;","executedQueryParameters":[]}}],"execution_count":60},{"source":"--- Checks whether any records are missing the company name, city, country, or continents.\n\nSELECT company, city, country, continent\nFROM companies\nWHERE company IS NULL \n\tAND city IS NULL\n\tAND country IS NULL\n\tAND continent IS NULL;","metadata":{"customType":"sql","dataFrameVariableName":"companies_nulls","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1384,"lastExecutedAt":1767706443478,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"--- Checks whether any records are missing the company name, city, country, or continents.\n\nSELECT company, city, country, continent\nFROM companies\nWHERE company IS NULL \n\tAND city IS NULL\n\tAND country IS NULL\n\tAND continent IS NULL;","outputsMetadata":{"0":{"height":38,"type":"dataFrame"}}},"cell_type":"code","id":"41da2d6d-e454-4501-bd51-b21d33fdc382","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"string"},{"name":"company","type":"integer"},{"name":"city","type":"integer"},{"name":"country","type":"integer"},{"name":"continent","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[],"company":[],"city":[],"country":[],"continent":[]}},"total_rows":0,"truncation_type":null},"text/plain":"Empty DataFrame\nColumns: [company, city, country, continent]\nIndex: []","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>company</th>\n      <th>city</th>\n      <th>country</th>\n      <th>continent</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":61,"@datacamp/metadata":{"executedQuery":"--- Checks whether any records are missing the company name, city, country, or continents.\n\nSELECT company, city, country, continent\nFROM companies\nWHERE company IS NULL \n\tAND city IS NULL\n\tAND country IS NULL\n\tAND continent IS NULL;","executedQueryParameters":[]}}],"execution_count":61},{"source":"# **Industry Concentration and High-Growth Sectors**","metadata":{},"cell_type":"markdown","id":"2dc67834-7858-4bd2-9445-78cf397e5705"},{"source":"-- Identify the top industries with the highest number of unicorn companies formed between 2019–2021\n\nSELECT  \n    i.industry,\n    COUNT(*) AS num_unicorns\nFROM industries AS i\nINNER JOIN dates AS d USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY i.industry\nORDER BY num_unicorns DESC\nLIMIT 5;","metadata":{"customType":"sql","dataFrameVariableName":"CTE1_top_performing_industries_","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":249,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"09168ba4-f332-4856-92e3-bf49440b9f7d","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"num_unicorns","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4],"industry":["Fintech","Internet software & services","E-commerce & direct-to-consumer","Artificial intelligence","Health"],"num_unicorns":[173,152,75,53,52]}},"total_rows":5,"truncation_type":null},"text/plain":"                          industry  num_unicorns\n0                          Fintech           173\n1     Internet software & services           152\n2  E-commerce & direct-to-consumer            75\n3          Artificial intelligence            53\n4                           Health            52","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>num_unicorns</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Fintech</td>\n      <td>173</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Internet software &amp; services</td>\n      <td>152</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>75</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Artificial intelligence</td>\n      <td>53</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Health</td>\n      <td>52</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":62,"@datacamp/metadata":{"executedQuery":"-- Identify the top industries with the highest number of unicorn companies formed between 2019–2021\n\nSELECT  \n    i.industry,\n    COUNT(*) AS num_unicorns\nFROM industries AS i\nINNER JOIN dates AS d USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY i.industry\nORDER BY num_unicorns DESC\nLIMIT 5;","executedQueryParameters":[]}}],"execution_count":62},{"source":"","metadata":{"customType":"visualization","dataFrameVariableName":"CTE1_top_performing_industries_","outputsMetadata":{"0":{"height":500,"type":"dataFrame","chartState":{"chartModel":{"modelType":"range","chartId":"id-nzwv68e9hy","chartType":"groupedBar","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}},"bar":{"axes":{"category":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Industries","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Industries","enabled":true}}},"number":{"bottom":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Number Of Unicorns","enabled":true}},"top":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Number Of Unicorns","enabled":true}}}},"series":{"label":{"fontFamily":"Charcoal, sans-serif","enabled":true}},"title":{"color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","text":"Top Unicorn-Producing Industries","enabled":true},"background":{"fill":"rgb(255, 255, 255)"}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["industry","num_unicorns"]},"switchCategorySeries":false,"suppressChartRanges":false,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":["industry","num_unicorns"],"switchCategorySeries":false},"activeTab":"format","sharedChartOptions":{"axes":{"category":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Industries","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Industries","enabled":true}}},"number":{"bottom":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Number Of Unicorns","enabled":true}},"top":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Number Of Unicorns","enabled":true}}}},"series":{"label":{"fontFamily":"Charcoal, sans-serif","enabled":true}},"title":{"color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","text":"Top Unicorn-Producing Industries","enabled":true},"background":{"fill":"rgb(255, 255, 255)"}},"isToolPanelOpen":false}}},"version":"ag-charts-v1","executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null},"cell_type":"code","id":"903962f8-8763-4199-ae4f-67413cd78dba","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"num_unicorns","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4],"industry":["Fintech","Internet software & services","E-commerce & direct-to-consumer","Artificial intelligence","Health"],"num_unicorns":[173,152,75,53,52]}},"total_rows":5,"truncation_type":null},"text/plain":"                          industry  num_unicorns\n0                          Fintech           173\n1     Internet software & services           152\n2  E-commerce & direct-to-consumer            75\n3          Artificial intelligence            53\n4                           Health            52","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>num_unicorns</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Fintech</td>\n      <td>173</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Internet software &amp; services</td>\n      <td>152</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>75</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Artificial intelligence</td>\n      <td>53</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Health</td>\n      <td>52</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":63}],"execution_count":63},{"source":"-- Analyze how unicorn creation and average valuation vary by industry and year\n\nSELECT \n    i.industry,\n    EXTRACT(YEAR FROM d.date_joined) AS year,\n    COUNT(i.company_id) AS num_unicorns,\n    ROUND(AVG(f.valuation), 2) AS avg_valuation\nFROM industries AS i\nINNER JOIN dates AS d USING(company_id)\nINNER JOIN funding AS f USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY i.industry, year\nORDER BY year ASC;","metadata":{"customType":"sql","dataFrameVariableName":"CTE2_top_valuation","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1213,"lastExecutedAt":1767706446054,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- Analyze how unicorn creation and average valuation vary by industry and year\n\nSELECT \n    i.industry,\n    EXTRACT(YEAR FROM d.date_joined) AS year,\n    COUNT(i.company_id) AS num_unicorns,\n    ROUND(AVG(f.valuation), 2) AS avg_valuation\nFROM industries AS i\nINNER JOIN dates AS d USING(company_id)\nINNER JOIN funding AS f USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY i.industry, year\nORDER BY year ASC;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"98a82363-6717-495a-aac6-3bb8637f14ff","nodeType":"const"}}}}},"cell_type":"code","id":"809021a1-8488-4404-a994-2346637d8a7c","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"},{"name":"avg_valuation","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],"industry":["Artificial intelligence","Auto & transportation","Consumer & retail","Cybersecurity","Data management & analytics","E-commerce & direct-to-consumer","Edtech","Fintech","Health","Internet software & services","Mobile & telecommunications","Other","Supply chain, logistics, & delivery","Travel","Artificial intelligence","Auto & transportation","Consumer & retail","Cybersecurity","Data management & analytics","E-commerce & direct-to-consumer","Edtech","Fintech","Hardware","Health","Internet software & services","Mobile & telecommunications","Other","Supply chain, logistics, & delivery","Artificial intelligence","Auto & transportation","Consumer & retail","Cybersecurity","Data management & analytics","E-commerce & direct-to-consumer","Edtech","Fintech","Hardware","Health","Internet software & services","Mobile & telecommunications","Other","Supply chain, logistics, & delivery","Travel"],"year":[2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021],"num_unicorns":[14,6,3,4,4,12,1,20,3,13,4,9,8,3,3,5,1,7,6,16,4,15,1,9,20,8,11,2,36,4,7,27,21,47,12,138,14,40,119,6,21,25,3],"avg_valuation":[4500000000,4166666666.67,3666666666.67,2250000000,11500000000,2583333333.33,1000000000,6800000000,3333333333.33,4230769230.77,2000000000,2888888888.89,3000000000,4000000000,4000000000,3000000000,15000000000,3285714285.71,3000000000,4000000000,2750000000,4333333333.33,2000000000,3111111111.11,4350000000,3125000000,3000000000,2000000000,1416666666.67,3750000000,2571428571.43,2518518518.52,2142857142.86,2468085106.38,2000000000,2753623188.41,2000000000,1950000000,2151260504.2,1833333333.33,1714285714.29,2200000000,2666666666.67]}},"total_rows":43,"truncation_type":null},"text/plain":"                               industry  year  num_unicorns  avg_valuation\n0               Artificial intelligence  2019            14   4.500000e+09\n1                 Auto & transportation  2019             6   4.166667e+09\n2                     Consumer & retail  2019             3   3.666667e+09\n3                         Cybersecurity  2019             4   2.250000e+09\n4           Data management & analytics  2019             4   1.150000e+10\n5       E-commerce & direct-to-consumer  2019            12   2.583333e+09\n6                                Edtech  2019             1   1.000000e+09\n7                               Fintech  2019            20   6.800000e+09\n8                                Health  2019             3   3.333333e+09\n9          Internet software & services  2019            13   4.230769e+09\n10          Mobile & telecommunications  2019             4   2.000000e+09\n11                                Other  2019             9   2.888889e+09\n12  Supply chain, logistics, & delivery  2019             8   3.000000e+09\n13                               Travel  2019             3   4.000000e+09\n14              Artificial intelligence  2020             3   4.000000e+09\n15                Auto & transportation  2020             5   3.000000e+09\n16                    Consumer & retail  2020             1   1.500000e+10\n17                        Cybersecurity  2020             7   3.285714e+09\n18          Data management & analytics  2020             6   3.000000e+09\n19      E-commerce & direct-to-consumer  2020            16   4.000000e+09\n20                               Edtech  2020             4   2.750000e+09\n21                              Fintech  2020            15   4.333333e+09\n22                             Hardware  2020             1   2.000000e+09\n23                               Health  2020             9   3.111111e+09\n24         Internet software & services  2020            20   4.350000e+09\n25          Mobile & telecommunications  2020             8   3.125000e+09\n26                                Other  2020            11   3.000000e+09\n27  Supply chain, logistics, & delivery  2020             2   2.000000e+09\n28              Artificial intelligence  2021            36   1.416667e+09\n29                Auto & transportation  2021             4   3.750000e+09\n30                    Consumer & retail  2021             7   2.571429e+09\n31                        Cybersecurity  2021            27   2.518519e+09\n32          Data management & analytics  2021            21   2.142857e+09\n33      E-commerce & direct-to-consumer  2021            47   2.468085e+09\n34                               Edtech  2021            12   2.000000e+09\n35                              Fintech  2021           138   2.753623e+09\n36                             Hardware  2021            14   2.000000e+09\n37                               Health  2021            40   1.950000e+09\n38         Internet software & services  2021           119   2.151261e+09\n39          Mobile & telecommunications  2021             6   1.833333e+09\n40                                Other  2021            21   1.714286e+09\n41  Supply chain, logistics, & delivery  2021            25   2.200000e+09\n42                               Travel  2021             3   2.666667e+09","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>year</th>\n      <th>num_unicorns</th>\n      <th>avg_valuation</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Artificial intelligence</td>\n      <td>2019</td>\n      <td>14</td>\n      <td>4.500000e+09</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Auto &amp; transportation</td>\n      <td>2019</td>\n      <td>6</td>\n      <td>4.166667e+09</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Consumer &amp; retail</td>\n      <td>2019</td>\n      <td>3</td>\n      <td>3.666667e+09</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Cybersecurity</td>\n      <td>2019</td>\n      <td>4</td>\n      <td>2.250000e+09</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Data management &amp; analytics</td>\n      <td>2019</td>\n      <td>4</td>\n      <td>1.150000e+10</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2019</td>\n      <td>12</td>\n      <td>2.583333e+09</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Edtech</td>\n      <td>2019</td>\n      <td>1</td>\n      <td>1.000000e+09</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Fintech</td>\n      <td>2019</td>\n      <td>20</td>\n      <td>6.800000e+09</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Health</td>\n      <td>2019</td>\n      <td>3</td>\n      <td>3.333333e+09</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Internet software &amp; services</td>\n      <td>2019</td>\n      <td>13</td>\n      <td>4.230769e+09</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2019</td>\n      <td>4</td>\n      <td>2.000000e+09</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Other</td>\n      <td>2019</td>\n      <td>9</td>\n      <td>2.888889e+09</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2019</td>\n      <td>8</td>\n      <td>3.000000e+09</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Travel</td>\n      <td>2019</td>\n      <td>3</td>\n      <td>4.000000e+09</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Artificial intelligence</td>\n      <td>2020</td>\n      <td>3</td>\n      <td>4.000000e+09</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Auto &amp; transportation</td>\n      <td>2020</td>\n      <td>5</td>\n      <td>3.000000e+09</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Consumer &amp; retail</td>\n      <td>2020</td>\n      <td>1</td>\n      <td>1.500000e+10</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Cybersecurity</td>\n      <td>2020</td>\n      <td>7</td>\n      <td>3.285714e+09</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Data management &amp; analytics</td>\n      <td>2020</td>\n      <td>6</td>\n      <td>3.000000e+09</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2020</td>\n      <td>16</td>\n      <td>4.000000e+09</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Edtech</td>\n      <td>2020</td>\n      <td>4</td>\n      <td>2.750000e+09</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Fintech</td>\n      <td>2020</td>\n      <td>15</td>\n      <td>4.333333e+09</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Hardware</td>\n      <td>2020</td>\n      <td>1</td>\n      <td>2.000000e+09</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Health</td>\n      <td>2020</td>\n      <td>9</td>\n      <td>3.111111e+09</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Internet software &amp; services</td>\n      <td>2020</td>\n      <td>20</td>\n      <td>4.350000e+09</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2020</td>\n      <td>8</td>\n      <td>3.125000e+09</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Other</td>\n      <td>2020</td>\n      <td>11</td>\n      <td>3.000000e+09</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2020</td>\n      <td>2</td>\n      <td>2.000000e+09</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Artificial intelligence</td>\n      <td>2021</td>\n      <td>36</td>\n      <td>1.416667e+09</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>Auto &amp; transportation</td>\n      <td>2021</td>\n      <td>4</td>\n      <td>3.750000e+09</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>Consumer &amp; retail</td>\n      <td>2021</td>\n      <td>7</td>\n      <td>2.571429e+09</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Cybersecurity</td>\n      <td>2021</td>\n      <td>27</td>\n      <td>2.518519e+09</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>Data management &amp; analytics</td>\n      <td>2021</td>\n      <td>21</td>\n      <td>2.142857e+09</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2021</td>\n      <td>47</td>\n      <td>2.468085e+09</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>Edtech</td>\n      <td>2021</td>\n      <td>12</td>\n      <td>2.000000e+09</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>Fintech</td>\n      <td>2021</td>\n      <td>138</td>\n      <td>2.753623e+09</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>Hardware</td>\n      <td>2021</td>\n      <td>14</td>\n      <td>2.000000e+09</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Health</td>\n      <td>2021</td>\n      <td>40</td>\n      <td>1.950000e+09</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>Internet software &amp; services</td>\n      <td>2021</td>\n      <td>119</td>\n      <td>2.151261e+09</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2021</td>\n      <td>6</td>\n      <td>1.833333e+09</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>Other</td>\n      <td>2021</td>\n      <td>21</td>\n      <td>1.714286e+09</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2021</td>\n      <td>25</td>\n      <td>2.200000e+09</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>Travel</td>\n      <td>2021</td>\n      <td>3</td>\n      <td>2.666667e+09</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":64,"@datacamp/metadata":{"executedQuery":"-- Analyze how unicorn creation and average valuation vary by industry and year\n\nSELECT \n    i.industry,\n    EXTRACT(YEAR FROM d.date_joined) AS year,\n    COUNT(i.company_id) AS num_unicorns,\n    ROUND(AVG(f.valuation), 2) AS avg_valuation\nFROM industries AS i\nINNER JOIN dates AS d USING(company_id)\nINNER JOIN funding AS f USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY i.industry, year\nORDER BY year ASC;","executedQueryParameters":[]}}],"execution_count":64},{"source":"# **Top Performing Industries and Valuation Trends (CTE-Based Analysis)**","metadata":{},"cell_type":"markdown","id":"5ec62935-356b-4808-80b7-414b508c7444"},{"source":"--- CTE1 top_performing_industries \n\n-- Select the top 3 industries based on total unicorn count\n\nWITH top_performing_industries AS (\n    SELECT  \n        i.industry,\n        COUNT(*) AS number_of_companies\n    FROM industries AS i\n    INNER JOIN dates AS d USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry\n    ORDER BY number_of_companies DESC\n    LIMIT 3\n),\n\n-----------------------------------------------------------------------------------------------------------\n\n--- CTE2 top_valuation \n\t\n-- Calculate yearly unicorn counts and average valuations for each industry\n\t\ntop_valuation AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(i.company_id) AS num_unicorns,\n        ROUND(AVG(f.valuation), 2) AS avg_valuation\n    FROM industries AS i\n    INNER JOIN dates AS d USING(company_id)\n    INNER JOIN funding AS f USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n)\n\n-----------------------------------------------------------------------------------------------------------\n\n--- Final Query \n\t\n-- Focus valuation analysis on top-performing industries only\n\t\nSELECT\n    industry,\n    year,\n    num_unicorns,\n    ROUND(AVG(avg_valuation) / 1000000000, 2) AS average_valuation_billions\nFROM top_valuation\nINNER JOIN top_performing_industries USING(industry)\nGROUP BY industry, year, num_unicorns\nORDER BY year DESC, num_unicorns DESC;","metadata":{"customType":"sql","dataFrameVariableName":"df","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":357,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"02a6483b-7074-42e1-b63d-ef95564c6e2e","nodeType":"const"}},"chartState":{"chartModel":{"modelType":"range","chartId":"id-5wdr0za1du","chartType":"groupedBar","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}},"bar":{"subtitle":{"enabled":false},"legend":{"enabled":false},"axes":{"category":{"left":{"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Industries","enabled":true},"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"}},"right":{"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Industries","enabled":true},"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"}}},"number":{"bottom":{"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Number Of Unicorns","enabled":true},"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"}},"top":{"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Number Of Unicorns","enabled":true},"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"}}}},"title":{"color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","text":"Top Unicorn-Producing Industries","enabled":true},"background":{"fill":"rgb(255, 255, 255)"},"animation":{"enabled":true}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["industry","num_unicorns"]},"switchCategorySeries":false,"suppressChartRanges":false,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":["industry","num_unicorns"],"switchCategorySeries":false},"activeTab":"format"}}},"visualizeDataframe":false,"version":"ag-charts-v1"},"cell_type":"code","id":"489dd868-72eb-427c-bd6d-d5830c81bd10","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"},{"name":"average_valuation_billions","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8],"industry":["Fintech","Internet software & services","E-commerce & direct-to-consumer","Internet software & services","E-commerce & direct-to-consumer","Fintech","Fintech","Internet software & services","E-commerce & direct-to-consumer"],"year":[2021,2021,2021,2020,2020,2020,2019,2019,2019],"num_unicorns":[138,119,47,20,16,15,20,13,12],"average_valuation_billions":[2.75,2.15,2.47,4.35,4,4.33,6.8,4.23,2.58]}},"total_rows":9,"truncation_type":null},"text/plain":"                          industry  ...  average_valuation_billions\n0                          Fintech  ...                        2.75\n1     Internet software & services  ...                        2.15\n2  E-commerce & direct-to-consumer  ...                        2.47\n3     Internet software & services  ...                        4.35\n4  E-commerce & direct-to-consumer  ...                        4.00\n5                          Fintech  ...                        4.33\n6                          Fintech  ...                        6.80\n7     Internet software & services  ...                        4.23\n8  E-commerce & direct-to-consumer  ...                        2.58\n\n[9 rows x 4 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>year</th>\n      <th>num_unicorns</th>\n      <th>average_valuation_billions</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Fintech</td>\n      <td>2021</td>\n      <td>138</td>\n      <td>2.75</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Internet software &amp; services</td>\n      <td>2021</td>\n      <td>119</td>\n      <td>2.15</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2021</td>\n      <td>47</td>\n      <td>2.47</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Internet software &amp; services</td>\n      <td>2020</td>\n      <td>20</td>\n      <td>4.35</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2020</td>\n      <td>16</td>\n      <td>4.00</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Fintech</td>\n      <td>2020</td>\n      <td>15</td>\n      <td>4.33</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Fintech</td>\n      <td>2019</td>\n      <td>20</td>\n      <td>6.80</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Internet software &amp; services</td>\n      <td>2019</td>\n      <td>13</td>\n      <td>4.23</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2019</td>\n      <td>12</td>\n      <td>2.58</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":65,"@datacamp/metadata":{"executedQuery":"--- CTE1 top_performing_industries \n\n-- Select the top 3 industries based on total unicorn count\n\nWITH top_performing_industries AS (\n    SELECT  \n        i.industry,\n        COUNT(*) AS number_of_companies\n    FROM industries AS i\n    INNER JOIN dates AS d USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry\n    ORDER BY number_of_companies DESC\n    LIMIT 3\n),\n\n-----------------------------------------------------------------------------------------------------------\n\n--- CTE2 top_valuation \n\t\n-- Calculate yearly unicorn counts and average valuations for each industry\n\t\ntop_valuation AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(i.company_id) AS num_unicorns,\n        ROUND(AVG(f.valuation), 2) AS avg_valuation\n    FROM industries AS i\n    INNER JOIN dates AS d USING(company_id)\n    INNER JOIN funding AS f USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n)\n\n-----------------------------------------------------------------------------------------------------------\n\n--- Final Query \n\t\n-- Focus valuation analysis on top-performing industries only\n\t\nSELECT\n    industry,\n    year,\n    num_unicorns,\n    ROUND(AVG(avg_valuation) / 1000000000, 2) AS average_valuation_billions\nFROM top_valuation\nINNER JOIN top_performing_industries USING(industry)\nGROUP BY industry, year, num_unicorns\nORDER BY year DESC, num_unicorns DESC;","executedQueryParameters":[]}}],"execution_count":65},{"source":"# **Speed of Value Creation (Time to Unicorn)**","metadata":{},"cell_type":"markdown","id":"9993e449-aaf7-4399-94ad-86ede1dff2c3"},{"source":"-- Measure how quickly companies reach unicorn status after being founded, by industry\n\nSELECT\n    i.industry,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(EXTRACT(YEAR FROM d.date_joined) - d.year_founded)::NUMERIC, 2) AS avg_years_to_unicorn,\n    ROUND(\n        PERCENTILE_CONT(0.5) \n        WITHIN GROUP (ORDER BY EXTRACT(YEAR FROM d.date_joined) - d.year_founded)::NUMERIC, \n        2\n    ) AS median_years_to_unicorn\nFROM industries i\nJOIN dates d USING(company_id)\nWHERE d.year_founded IS NOT NULL\nGROUP BY i.industry\nORDER BY avg_years_to_unicorn ASC;","metadata":{"customType":"sql","dataFrameVariableName":"years_to_unicorns","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":519,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"a56a5911-adae-4a0c-bf8e-33f6b17ce9fe","nodeType":"const"}},"chartState":{"chartModel":{"modelType":"range","chartId":"id-pxhlqfls6r","chartType":"groupedColumn","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["industry","avg_years_to_unicorn","median_years_to_unicorn"]},"switchCategorySeries":false,"suppressChartRanges":false,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":["industry","avg_years_to_unicorn","median_years_to_unicorn"],"switchCategorySeries":false},"activeTab":"data"}}},"visualizeDataframe":false,"version":"ag-charts-v1"},"cell_type":"code","id":"fa30eec6-73f8-4d42-8edd-06aa7ed20c62","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"num_unicorns","type":"integer"},{"name":"avg_years_to_unicorn","type":"number"},{"name":"median_years_to_unicorn","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"industry":["Auto & transportation","Artificial intelligence","Hardware","Mobile & telecommunications","E-commerce & direct-to-consumer","Fintech","Travel","Cybersecurity","Supply chain, logistics, & delivery","Edtech","Other","Internet software & services","Data management & analytics","Consumer & retail","Health"],"num_unicorns":[31,84,34,38,111,224,14,50,57,28,58,205,41,25,74],"avg_years_to_unicorn":[5.03,5.89,5.94,6.32,6.43,6.54,6.57,6.8,6.93,7.71,7.78,7.87,8.07,8.08,8.19],"median_years_to_unicorn":[4,5,5,5,6,6,5,6,6,6,6.5,7,8,5,6]}},"total_rows":15,"truncation_type":null},"text/plain":"                               industry  ...  median_years_to_unicorn\n0                 Auto & transportation  ...                      4.0\n1               Artificial intelligence  ...                      5.0\n2                              Hardware  ...                      5.0\n3           Mobile & telecommunications  ...                      5.0\n4       E-commerce & direct-to-consumer  ...                      6.0\n5                               Fintech  ...                      6.0\n6                                Travel  ...                      5.0\n7                         Cybersecurity  ...                      6.0\n8   Supply chain, logistics, & delivery  ...                      6.0\n9                                Edtech  ...                      6.0\n10                                Other  ...                      6.5\n11         Internet software & services  ...                      7.0\n12          Data management & analytics  ...                      8.0\n13                    Consumer & retail  ...                      5.0\n14                               Health  ...                      6.0\n\n[15 rows x 4 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>num_unicorns</th>\n      <th>avg_years_to_unicorn</th>\n      <th>median_years_to_unicorn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Auto &amp; transportation</td>\n      <td>31</td>\n      <td>5.03</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Artificial intelligence</td>\n      <td>84</td>\n      <td>5.89</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Hardware</td>\n      <td>34</td>\n      <td>5.94</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>38</td>\n      <td>6.32</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>111</td>\n      <td>6.43</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Fintech</td>\n      <td>224</td>\n      <td>6.54</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Travel</td>\n      <td>14</td>\n      <td>6.57</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Cybersecurity</td>\n      <td>50</td>\n      <td>6.80</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>57</td>\n      <td>6.93</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Edtech</td>\n      <td>28</td>\n      <td>7.71</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Other</td>\n      <td>58</td>\n      <td>7.78</td>\n      <td>6.5</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Internet software &amp; services</td>\n      <td>205</td>\n      <td>7.87</td>\n      <td>7.0</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Data management &amp; analytics</td>\n      <td>41</td>\n      <td>8.07</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Consumer &amp; retail</td>\n      <td>25</td>\n      <td>8.08</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Health</td>\n      <td>74</td>\n      <td>8.19</td>\n      <td>6.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":66,"@datacamp/metadata":{"executedQuery":"-- Measure how quickly companies reach unicorn status after being founded, by industry\n\nSELECT\n    i.industry,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(EXTRACT(YEAR FROM d.date_joined) - d.year_founded)::NUMERIC, 2) AS avg_years_to_unicorn,\n    ROUND(\n        PERCENTILE_CONT(0.5) \n        WITHIN GROUP (ORDER BY EXTRACT(YEAR FROM d.date_joined) - d.year_founded)::NUMERIC, \n        2\n    ) AS median_years_to_unicorn\nFROM industries i\nJOIN dates d USING(company_id)\nWHERE d.year_founded IS NOT NULL\nGROUP BY i.industry\nORDER BY avg_years_to_unicorn ASC;","executedQueryParameters":[]}}],"execution_count":66},{"source":"# **Capital Efficiency Analysis**","metadata":{},"cell_type":"markdown","id":"7f93676d-a85c-40bf-ac52-87107fe975bc"},{"source":"-- Evaluate capital efficiency by comparing valuation generated per dollar of funding\n\nSELECT \n    i.industry,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation / NULLIF(f.funding, 0))::NUMERIC, 2) AS avg_valuation_funding_ratio,\n    ROUND(\n        PERCENTILE_CONT(0.5) \n        WITHIN GROUP (ORDER BY f.valuation / NULLIF(f.funding, 0))::NUMERIC, \n        2\n    ) AS median_valuation_funding_ratio\nFROM funding f\nJOIN industries i USING(company_id)\nWHERE f.funding > 0\nGROUP BY i.industry\nORDER BY avg_valuation_funding_ratio DESC;","metadata":{"customType":"sql","dataFrameVariableName":"valuation_funding_ratio","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":534,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"},"quickFilterText":""}}}},"cell_type":"code","id":"83f022c3-bb86-4563-a68d-d0730ac284da","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"num_unicorns","type":"integer"},{"name":"avg_valuation_funding_ratio","type":"number"},{"name":"median_valuation_funding_ratio","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"industry":["Internet software & services","Other","Mobile & telecommunications","Fintech","Hardware","Consumer & retail","Data management & analytics","Artificial intelligence","Health","E-commerce & direct-to-consumer","Cybersecurity","Edtech","Auto & transportation","Supply chain, logistics, & delivery","Travel"],"num_unicorns":[203,56,37,222,34,24,40,84,73,109,50,28,31,56,14],"avg_valuation_funding_ratio":[28.3,8.98,8.92,8.72,7.59,7.5,6.25,6,5.82,5.63,5.58,5.39,3.97,3.32,2.93],"median_valuation_funding_ratio":[6,4,5,6,5,3.5,5.5,4.5,5,4,5,5,2,3,2.5]}},"total_rows":15,"truncation_type":null},"text/plain":"                               industry  ...  median_valuation_funding_ratio\n0          Internet software & services  ...                             6.0\n1                                 Other  ...                             4.0\n2           Mobile & telecommunications  ...                             5.0\n3                               Fintech  ...                             6.0\n4                              Hardware  ...                             5.0\n5                     Consumer & retail  ...                             3.5\n6           Data management & analytics  ...                             5.5\n7               Artificial intelligence  ...                             4.5\n8                                Health  ...                             5.0\n9       E-commerce & direct-to-consumer  ...                             4.0\n10                        Cybersecurity  ...                             5.0\n11                               Edtech  ...                             5.0\n12                Auto & transportation  ...                             2.0\n13  Supply chain, logistics, & delivery  ...                             3.0\n14                               Travel  ...                             2.5\n\n[15 rows x 4 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>num_unicorns</th>\n      <th>avg_valuation_funding_ratio</th>\n      <th>median_valuation_funding_ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Internet software &amp; services</td>\n      <td>203</td>\n      <td>28.30</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Other</td>\n      <td>56</td>\n      <td>8.98</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>37</td>\n      <td>8.92</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Fintech</td>\n      <td>222</td>\n      <td>8.72</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Hardware</td>\n      <td>34</td>\n      <td>7.59</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Consumer &amp; retail</td>\n      <td>24</td>\n      <td>7.50</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Data management &amp; analytics</td>\n      <td>40</td>\n      <td>6.25</td>\n      <td>5.5</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Artificial intelligence</td>\n      <td>84</td>\n      <td>6.00</td>\n      <td>4.5</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Health</td>\n      <td>73</td>\n      <td>5.82</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>109</td>\n      <td>5.63</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Cybersecurity</td>\n      <td>50</td>\n      <td>5.58</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Edtech</td>\n      <td>28</td>\n      <td>5.39</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Auto &amp; transportation</td>\n      <td>31</td>\n      <td>3.97</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>56</td>\n      <td>3.32</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Travel</td>\n      <td>14</td>\n      <td>2.93</td>\n      <td>2.5</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":67,"@datacamp/metadata":{"executedQuery":"-- Evaluate capital efficiency by comparing valuation generated per dollar of funding\n\nSELECT \n    i.industry,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation / NULLIF(f.funding, 0))::NUMERIC, 2) AS avg_valuation_funding_ratio,\n    ROUND(\n        PERCENTILE_CONT(0.5) \n        WITHIN GROUP (ORDER BY f.valuation / NULLIF(f.funding, 0))::NUMERIC, \n        2\n    ) AS median_valuation_funding_ratio\nFROM funding f\nJOIN industries i USING(company_id)\nWHERE f.funding > 0\nGROUP BY i.industry\nORDER BY avg_valuation_funding_ratio DESC;","executedQueryParameters":[]}}],"execution_count":67},{"source":"# **Year-over-Year Unicorn Growth Trends**","metadata":{},"cell_type":"markdown","id":"e4e1b174-de9c-458f-a14a-46972fc6217b"},{"source":"-- Count unicorns created each year within each industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n\tWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n)\nSELECT *\nFROM unicorns_by_year\nORDER BY industry, year;","metadata":{"customType":"sql","dataFrameVariableName":"unicorns_by_year","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1234,"lastExecutedAt":1767706451031,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- Count unicorns created each year within each industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n\tWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n)\nSELECT *\nFROM unicorns_by_year\nORDER BY industry, year;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"a56a5911-adae-4a0c-bf8e-33f6b17ce9fe","nodeType":"const"}}}}},"cell_type":"code","id":"8321c44d-e8c5-4c7a-8ee6-8dd634e71878","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],"industry":["Artificial intelligence","Artificial intelligence","Artificial intelligence","Auto & transportation","Auto & transportation","Auto & transportation","Consumer & retail","Consumer & retail","Consumer & retail","Cybersecurity","Cybersecurity","Cybersecurity","Data management & analytics","Data management & analytics","Data management & analytics","E-commerce & direct-to-consumer","E-commerce & direct-to-consumer","E-commerce & direct-to-consumer","Edtech","Edtech","Edtech","Fintech","Fintech","Fintech","Hardware","Hardware","Health","Health","Health","Internet software & services","Internet software & services","Internet software & services","Mobile & telecommunications","Mobile & telecommunications","Mobile & telecommunications","Other","Other","Other","Supply chain, logistics, & delivery","Supply chain, logistics, & delivery","Supply chain, logistics, & delivery","Travel","Travel"],"year":[2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2021],"num_unicorns":[14,3,36,6,5,4,3,1,7,4,7,27,4,6,21,12,16,47,1,4,12,20,15,138,1,14,3,9,40,13,20,119,4,8,6,9,11,21,8,2,25,3,3]}},"total_rows":43,"truncation_type":null},"text/plain":"                               industry  year  num_unicorns\n0               Artificial intelligence  2019            14\n1               Artificial intelligence  2020             3\n2               Artificial intelligence  2021            36\n3                 Auto & transportation  2019             6\n4                 Auto & transportation  2020             5\n5                 Auto & transportation  2021             4\n6                     Consumer & retail  2019             3\n7                     Consumer & retail  2020             1\n8                     Consumer & retail  2021             7\n9                         Cybersecurity  2019             4\n10                        Cybersecurity  2020             7\n11                        Cybersecurity  2021            27\n12          Data management & analytics  2019             4\n13          Data management & analytics  2020             6\n14          Data management & analytics  2021            21\n15      E-commerce & direct-to-consumer  2019            12\n16      E-commerce & direct-to-consumer  2020            16\n17      E-commerce & direct-to-consumer  2021            47\n18                               Edtech  2019             1\n19                               Edtech  2020             4\n20                               Edtech  2021            12\n21                              Fintech  2019            20\n22                              Fintech  2020            15\n23                              Fintech  2021           138\n24                             Hardware  2020             1\n25                             Hardware  2021            14\n26                               Health  2019             3\n27                               Health  2020             9\n28                               Health  2021            40\n29         Internet software & services  2019            13\n30         Internet software & services  2020            20\n31         Internet software & services  2021           119\n32          Mobile & telecommunications  2019             4\n33          Mobile & telecommunications  2020             8\n34          Mobile & telecommunications  2021             6\n35                                Other  2019             9\n36                                Other  2020            11\n37                                Other  2021            21\n38  Supply chain, logistics, & delivery  2019             8\n39  Supply chain, logistics, & delivery  2020             2\n40  Supply chain, logistics, & delivery  2021            25\n41                               Travel  2019             3\n42                               Travel  2021             3","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>year</th>\n      <th>num_unicorns</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Artificial intelligence</td>\n      <td>2019</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Artificial intelligence</td>\n      <td>2020</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Artificial intelligence</td>\n      <td>2021</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Auto &amp; transportation</td>\n      <td>2019</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Auto &amp; transportation</td>\n      <td>2020</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Auto &amp; transportation</td>\n      <td>2021</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Consumer &amp; retail</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Consumer &amp; retail</td>\n      <td>2020</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Consumer &amp; retail</td>\n      <td>2021</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Cybersecurity</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Cybersecurity</td>\n      <td>2020</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Cybersecurity</td>\n      <td>2021</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Data management &amp; analytics</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Data management &amp; analytics</td>\n      <td>2020</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Data management &amp; analytics</td>\n      <td>2021</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2019</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2020</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2021</td>\n      <td>47</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Edtech</td>\n      <td>2019</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Edtech</td>\n      <td>2020</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Edtech</td>\n      <td>2021</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Fintech</td>\n      <td>2019</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Fintech</td>\n      <td>2020</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Fintech</td>\n      <td>2021</td>\n      <td>138</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Hardware</td>\n      <td>2020</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Hardware</td>\n      <td>2021</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Health</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Health</td>\n      <td>2020</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Health</td>\n      <td>2021</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>Internet software &amp; services</td>\n      <td>2019</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>Internet software &amp; services</td>\n      <td>2020</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Internet software &amp; services</td>\n      <td>2021</td>\n      <td>119</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2020</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2021</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>Other</td>\n      <td>2019</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>Other</td>\n      <td>2020</td>\n      <td>11</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Other</td>\n      <td>2021</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2019</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2020</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2021</td>\n      <td>25</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>Travel</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>Travel</td>\n      <td>2021</td>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":68,"@datacamp/metadata":{"executedQuery":"-- Count unicorns created each year within each industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n\tWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n)\nSELECT *\nFROM unicorns_by_year\nORDER BY industry, year;","executedQueryParameters":[]}}],"execution_count":68},{"source":"-- Calculate year-over-year growth rate in unicorn creation for each industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n\tWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n),\n\t\nyoy_growth AS (\n    SELECT \n        industry,\n        year,\n        num_unicorns,\n        LAG(num_unicorns) OVER (PARTITION BY industry ORDER BY year) AS prev_year_unicorns\n    FROM unicorns_by_year\n)\n\t\nSELECT\n    industry,\n    year,\n    num_unicorns,\n    prev_year_unicorns,\n    ROUND(\n        (num_unicorns - prev_year_unicorns) * 100.0 / NULLIF(prev_year_unicorns, 0),\n        2\n    ) AS yoy_growth_percentage\nFROM yoy_growth\nORDER BY yoy_growth_percentage DESC;","metadata":{"customType":"sql","dataFrameVariableName":"YoY_growth","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1522,"lastExecutedAt":1767706452553,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- Calculate year-over-year growth rate in unicorn creation for each industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n\tWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n),\n\t\nyoy_growth AS (\n    SELECT \n        industry,\n        year,\n        num_unicorns,\n        LAG(num_unicorns) OVER (PARTITION BY industry ORDER BY year) AS prev_year_unicorns\n    FROM unicorns_by_year\n)\n\t\nSELECT\n    industry,\n    year,\n    num_unicorns,\n    prev_year_unicorns,\n    ROUND(\n        (num_unicorns - prev_year_unicorns) * 100.0 / NULLIF(prev_year_unicorns, 0),\n        2\n    ) AS yoy_growth_percentage\nFROM yoy_growth\nORDER BY yoy_growth_percentage DESC;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"},"sort":{"sortModel":[{"colId":"yoy_growth_percentage","sort":"desc"}]},"quickFilterText":""},"chartState":{"chartModel":{"modelType":"pivot","chartId":"id-enu579idvq","chartType":"line","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["ag-Grid-AutoColumn","pivot_year-yoy_growth_percentage_2020_num_unicorns","pivot_year-yoy_growth_percentage_2021_num_unicorns"]},"switchCategorySeries":false,"suppressChartRanges":true,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":["industry","yoy_growth_percentage"],"switchCategorySeries":false},"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"},"activeTab":"data","pivotMode":{"enabled":true,"config":{"rowGroup":{"groupColIds":["industry"]},"aggregation":{"aggregationModel":[{"aggFunc":"avg","id":"ecce14b4-1b7f-4b5f-8904-e64730b3f678","colId":"num_unicorns"}]},"pivot":{"pivotColIds":["year","yoy_growth_percentage"]}}},"sharedChartOptions":{"legend":{"enabled":false}}}}},"visualizeDataframe":false,"version":"ag-charts-v1"},"cell_type":"code","id":"19c13ede-1f9c-40d5-8f6c-36c7f69b70b7","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"},{"name":"prev_year_unicorns","type":"number"},{"name":"yoy_growth_percentage","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],"industry":["Fintech","Travel","Data management & analytics","Health","E-commerce & direct-to-consumer","Mobile & telecommunications","Hardware","Edtech","Auto & transportation","Supply chain, logistics, & delivery","Consumer & retail","Artificial intelligence","Cybersecurity","Other","Internet software & services","Hardware","Supply chain, logistics, & delivery","Artificial intelligence","Fintech","Consumer & retail","Internet software & services","Health","Edtech","Cybersecurity","Data management & analytics","Edtech","Health","E-commerce & direct-to-consumer","Mobile & telecommunications","Other","Cybersecurity","Internet software & services","Data management & analytics","E-commerce & direct-to-consumer","Other","Travel","Auto & transportation","Auto & transportation","Mobile & telecommunications","Fintech","Consumer & retail","Supply chain, logistics, & delivery","Artificial intelligence"],"year":[2019,2019,2019,2019,2019,2019,2020,2019,2019,2019,2019,2019,2019,2019,2019,2021,2021,2021,2021,2021,2021,2021,2020,2021,2021,2021,2020,2021,2020,2021,2020,2020,2020,2020,2020,2021,2020,2021,2021,2020,2020,2020,2020],"num_unicorns":[20,3,4,3,12,4,1,1,6,8,3,14,4,9,13,14,25,36,138,7,119,40,4,27,21,12,9,47,8,21,7,20,6,16,11,3,5,4,6,15,1,2,3],"prev_year_unicorns":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,15,1,20,9,1,7,6,4,3,16,4,11,4,13,4,12,9,3,6,5,8,20,3,8,14],"yoy_growth_percentage":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1300,1150,1100,820,600,495,344.44,300,285.71,250,200,200,193.75,100,90.91,75,53.85,50,33.33,22.22,0,-16.67,-20,-25,-25,-66.67,-75,-78.57]}},"total_rows":43,"truncation_type":null},"text/plain":"                               industry  ...  yoy_growth_percentage\n0                               Fintech  ...                    NaN\n1                                Travel  ...                    NaN\n2           Data management & analytics  ...                    NaN\n3                                Health  ...                    NaN\n4       E-commerce & direct-to-consumer  ...                    NaN\n5           Mobile & telecommunications  ...                    NaN\n6                              Hardware  ...                    NaN\n7                                Edtech  ...                    NaN\n8                 Auto & transportation  ...                    NaN\n9   Supply chain, logistics, & delivery  ...                    NaN\n10                    Consumer & retail  ...                    NaN\n11              Artificial intelligence  ...                    NaN\n12                        Cybersecurity  ...                    NaN\n13                                Other  ...                    NaN\n14         Internet software & services  ...                    NaN\n15                             Hardware  ...                1300.00\n16  Supply chain, logistics, & delivery  ...                1150.00\n17              Artificial intelligence  ...                1100.00\n18                              Fintech  ...                 820.00\n19                    Consumer & retail  ...                 600.00\n20         Internet software & services  ...                 495.00\n21                               Health  ...                 344.44\n22                               Edtech  ...                 300.00\n23                        Cybersecurity  ...                 285.71\n24          Data management & analytics  ...                 250.00\n25                               Edtech  ...                 200.00\n26                               Health  ...                 200.00\n27      E-commerce & direct-to-consumer  ...                 193.75\n28          Mobile & telecommunications  ...                 100.00\n29                                Other  ...                  90.91\n30                        Cybersecurity  ...                  75.00\n31         Internet software & services  ...                  53.85\n32          Data management & analytics  ...                  50.00\n33      E-commerce & direct-to-consumer  ...                  33.33\n34                                Other  ...                  22.22\n35                               Travel  ...                   0.00\n36                Auto & transportation  ...                 -16.67\n37                Auto & transportation  ...                 -20.00\n38          Mobile & telecommunications  ...                 -25.00\n39                              Fintech  ...                 -25.00\n40                    Consumer & retail  ...                 -66.67\n41  Supply chain, logistics, & delivery  ...                 -75.00\n42              Artificial intelligence  ...                 -78.57\n\n[43 rows x 5 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>year</th>\n      <th>num_unicorns</th>\n      <th>prev_year_unicorns</th>\n      <th>yoy_growth_percentage</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Fintech</td>\n      <td>2019</td>\n      <td>20</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Travel</td>\n      <td>2019</td>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Data management &amp; analytics</td>\n      <td>2019</td>\n      <td>4</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Health</td>\n      <td>2019</td>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2019</td>\n      <td>12</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2019</td>\n      <td>4</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Hardware</td>\n      <td>2020</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Edtech</td>\n      <td>2019</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Auto &amp; transportation</td>\n      <td>2019</td>\n      <td>6</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2019</td>\n      <td>8</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Consumer &amp; retail</td>\n      <td>2019</td>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Artificial intelligence</td>\n      <td>2019</td>\n      <td>14</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Cybersecurity</td>\n      <td>2019</td>\n      <td>4</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Other</td>\n      <td>2019</td>\n      <td>9</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Internet software &amp; services</td>\n      <td>2019</td>\n      <td>13</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Hardware</td>\n      <td>2021</td>\n      <td>14</td>\n      <td>1.0</td>\n      <td>1300.00</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2021</td>\n      <td>25</td>\n      <td>2.0</td>\n      <td>1150.00</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Artificial intelligence</td>\n      <td>2021</td>\n      <td>36</td>\n      <td>3.0</td>\n      <td>1100.00</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Fintech</td>\n      <td>2021</td>\n      <td>138</td>\n      <td>15.0</td>\n      <td>820.00</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Consumer &amp; retail</td>\n      <td>2021</td>\n      <td>7</td>\n      <td>1.0</td>\n      <td>600.00</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Internet software &amp; services</td>\n      <td>2021</td>\n      <td>119</td>\n      <td>20.0</td>\n      <td>495.00</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Health</td>\n      <td>2021</td>\n      <td>40</td>\n      <td>9.0</td>\n      <td>344.44</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Edtech</td>\n      <td>2020</td>\n      <td>4</td>\n      <td>1.0</td>\n      <td>300.00</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Cybersecurity</td>\n      <td>2021</td>\n      <td>27</td>\n      <td>7.0</td>\n      <td>285.71</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Data management &amp; analytics</td>\n      <td>2021</td>\n      <td>21</td>\n      <td>6.0</td>\n      <td>250.00</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Edtech</td>\n      <td>2021</td>\n      <td>12</td>\n      <td>4.0</td>\n      <td>200.00</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Health</td>\n      <td>2020</td>\n      <td>9</td>\n      <td>3.0</td>\n      <td>200.00</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2021</td>\n      <td>47</td>\n      <td>16.0</td>\n      <td>193.75</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2020</td>\n      <td>8</td>\n      <td>4.0</td>\n      <td>100.00</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>Other</td>\n      <td>2021</td>\n      <td>21</td>\n      <td>11.0</td>\n      <td>90.91</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>Cybersecurity</td>\n      <td>2020</td>\n      <td>7</td>\n      <td>4.0</td>\n      <td>75.00</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Internet software &amp; services</td>\n      <td>2020</td>\n      <td>20</td>\n      <td>13.0</td>\n      <td>53.85</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>Data management &amp; analytics</td>\n      <td>2020</td>\n      <td>6</td>\n      <td>4.0</td>\n      <td>50.00</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>2020</td>\n      <td>16</td>\n      <td>12.0</td>\n      <td>33.33</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>Other</td>\n      <td>2020</td>\n      <td>11</td>\n      <td>9.0</td>\n      <td>22.22</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>Travel</td>\n      <td>2021</td>\n      <td>3</td>\n      <td>3.0</td>\n      <td>0.00</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>Auto &amp; transportation</td>\n      <td>2020</td>\n      <td>5</td>\n      <td>6.0</td>\n      <td>-16.67</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Auto &amp; transportation</td>\n      <td>2021</td>\n      <td>4</td>\n      <td>5.0</td>\n      <td>-20.00</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>2021</td>\n      <td>6</td>\n      <td>8.0</td>\n      <td>-25.00</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>Fintech</td>\n      <td>2020</td>\n      <td>15</td>\n      <td>20.0</td>\n      <td>-25.00</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>Consumer &amp; retail</td>\n      <td>2020</td>\n      <td>1</td>\n      <td>3.0</td>\n      <td>-66.67</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2020</td>\n      <td>2</td>\n      <td>8.0</td>\n      <td>-75.00</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>Artificial intelligence</td>\n      <td>2020</td>\n      <td>3</td>\n      <td>14.0</td>\n      <td>-78.57</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":69,"@datacamp/metadata":{"executedQuery":"-- Calculate year-over-year growth rate in unicorn creation for each industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n\tWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n),\n\t\nyoy_growth AS (\n    SELECT \n        industry,\n        year,\n        num_unicorns,\n        LAG(num_unicorns) OVER (PARTITION BY industry ORDER BY year) AS prev_year_unicorns\n    FROM unicorns_by_year\n)\n\t\nSELECT\n    industry,\n    year,\n    num_unicorns,\n    prev_year_unicorns,\n    ROUND(\n        (num_unicorns - prev_year_unicorns) * 100.0 / NULLIF(prev_year_unicorns, 0),\n        2\n    ) AS yoy_growth_percentage\nFROM yoy_growth\nORDER BY yoy_growth_percentage DESC;","executedQueryParameters":[]}}],"execution_count":69},{"source":"-- Calculate year-over-year growth rate in unicorn creation for top 10 industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n),\n\nyoy_growth AS (\n    SELECT \n        industry,\n        year,\n        num_unicorns,\n        LAG(num_unicorns) OVER (PARTITION BY industry ORDER BY year) AS prev_year_unicorns\n    FROM unicorns_by_year\n),\n\ntop_industries AS (\n    SELECT\n        industry\n    FROM yoy_growth\n    WHERE year = 2021\n    ORDER BY \n        (num_unicorns - prev_year_unicorns) * 1.0 / prev_year_unicorns DESC\n    LIMIT 10\n)\n\nSELECT \n    u.industry,\n    u.year,\n    u.num_unicorns\nFROM unicorns_by_year u\nJOIN top_industries t \n  ON u.industry = t.industry\nORDER BY u.industry, u.year;","metadata":{"customType":"sql","dataFrameVariableName":"top_10_YoY_growth","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1158,"lastExecutedAt":1767706453712,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- Calculate year-over-year growth rate in unicorn creation for top 10 industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n),\n\nyoy_growth AS (\n    SELECT \n        industry,\n        year,\n        num_unicorns,\n        LAG(num_unicorns) OVER (PARTITION BY industry ORDER BY year) AS prev_year_unicorns\n    FROM unicorns_by_year\n),\n\ntop_industries AS (\n    SELECT\n        industry\n    FROM yoy_growth\n    WHERE year = 2021\n    ORDER BY \n        (num_unicorns - prev_year_unicorns) * 1.0 / prev_year_unicorns DESC\n    LIMIT 10\n)\n\nSELECT \n    u.industry,\n    u.year,\n    u.num_unicorns\nFROM unicorns_by_year u\nJOIN top_industries t \n  ON u.industry = t.industry\nORDER BY u.industry, u.year;","outputsMetadata":{"0":{"height":550,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"8b16ba36-31dd-47c4-8111-9de2e77f1975","nodeType":"const"}}}}},"cell_type":"code","id":"d97b31cc-b579-49e1-b426-a7839b1d56f9","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"industry":["Artificial intelligence","Artificial intelligence","Artificial intelligence","Consumer & retail","Consumer & retail","Consumer & retail","Cybersecurity","Cybersecurity","Cybersecurity","Data management & analytics","Data management & analytics","Data management & analytics","Edtech","Edtech","Edtech","Fintech","Fintech","Fintech","Hardware","Hardware","Health","Health","Health","Internet software & services","Internet software & services","Internet software & services","Supply chain, logistics, & delivery","Supply chain, logistics, & delivery","Supply chain, logistics, & delivery"],"year":[2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021],"num_unicorns":[14,3,36,3,1,7,4,7,27,4,6,21,1,4,12,20,15,138,1,14,3,9,40,13,20,119,8,2,25]}},"total_rows":29,"truncation_type":null},"text/plain":"                               industry  year  num_unicorns\n0               Artificial intelligence  2019            14\n1               Artificial intelligence  2020             3\n2               Artificial intelligence  2021            36\n3                     Consumer & retail  2019             3\n4                     Consumer & retail  2020             1\n5                     Consumer & retail  2021             7\n6                         Cybersecurity  2019             4\n7                         Cybersecurity  2020             7\n8                         Cybersecurity  2021            27\n9           Data management & analytics  2019             4\n10          Data management & analytics  2020             6\n11          Data management & analytics  2021            21\n12                               Edtech  2019             1\n13                               Edtech  2020             4\n14                               Edtech  2021            12\n15                              Fintech  2019            20\n16                              Fintech  2020            15\n17                              Fintech  2021           138\n18                             Hardware  2020             1\n19                             Hardware  2021            14\n20                               Health  2019             3\n21                               Health  2020             9\n22                               Health  2021            40\n23         Internet software & services  2019            13\n24         Internet software & services  2020            20\n25         Internet software & services  2021           119\n26  Supply chain, logistics, & delivery  2019             8\n27  Supply chain, logistics, & delivery  2020             2\n28  Supply chain, logistics, & delivery  2021            25","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>year</th>\n      <th>num_unicorns</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Artificial intelligence</td>\n      <td>2019</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Artificial intelligence</td>\n      <td>2020</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Artificial intelligence</td>\n      <td>2021</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Consumer &amp; retail</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Consumer &amp; retail</td>\n      <td>2020</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Consumer &amp; retail</td>\n      <td>2021</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Cybersecurity</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Cybersecurity</td>\n      <td>2020</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Cybersecurity</td>\n      <td>2021</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Data management &amp; analytics</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Data management &amp; analytics</td>\n      <td>2020</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Data management &amp; analytics</td>\n      <td>2021</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Edtech</td>\n      <td>2019</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Edtech</td>\n      <td>2020</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Edtech</td>\n      <td>2021</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Fintech</td>\n      <td>2019</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Fintech</td>\n      <td>2020</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Fintech</td>\n      <td>2021</td>\n      <td>138</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Hardware</td>\n      <td>2020</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Hardware</td>\n      <td>2021</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Health</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Health</td>\n      <td>2020</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Health</td>\n      <td>2021</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Internet software &amp; services</td>\n      <td>2019</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Internet software &amp; services</td>\n      <td>2020</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Internet software &amp; services</td>\n      <td>2021</td>\n      <td>119</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2019</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2020</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2021</td>\n      <td>25</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":70,"@datacamp/metadata":{"executedQuery":"-- Calculate year-over-year growth rate in unicorn creation for top 10 industry\n\nWITH unicorns_by_year AS (\n    SELECT \n        i.industry,\n        EXTRACT(YEAR FROM d.date_joined) AS year,\n        COUNT(*) AS num_unicorns\n    FROM industries i\n    JOIN dates d USING(company_id)\n    WHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\n    GROUP BY i.industry, year\n),\n\nyoy_growth AS (\n    SELECT \n        industry,\n        year,\n        num_unicorns,\n        LAG(num_unicorns) OVER (PARTITION BY industry ORDER BY year) AS prev_year_unicorns\n    FROM unicorns_by_year\n),\n\ntop_industries AS (\n    SELECT\n        industry\n    FROM yoy_growth\n    WHERE year = 2021\n    ORDER BY \n        (num_unicorns - prev_year_unicorns) * 1.0 / prev_year_unicorns DESC\n    LIMIT 10\n)\n\nSELECT \n    u.industry,\n    u.year,\n    u.num_unicorns\nFROM unicorns_by_year u\nJOIN top_industries t \n  ON u.industry = t.industry\nORDER BY u.industry, u.year;","executedQueryParameters":[]}}],"execution_count":70},{"source":"","metadata":{"customType":"visualization","dataFrameVariableName":"top_10_YoY_growth","outputsMetadata":{"0":{"height":500,"type":"dataFrame","chartState":{"chartModel":{"modelType":"pivot","chartId":"id-ovywvjr222a","chartType":"line","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}},"line":{"title":{"text":"Year-over-Year Growth in Unicorn Creation by Top 10  Industries [2019-2022]","color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","enabled":true},"series":{"marker":{"enabled":false,"size":5,"shape":"cross"},"strokeWidth":3,"strokeOpacity":1,"label":{"enabled":false}},"axes":{"grouped-category":{"bottom":{"label":{"padding":15,"rotation":0,"autoRotate":false,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}},"top":{"label":{"padding":15,"rotation":0,"autoRotate":false,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}}},"number":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","text":"Number Of Unicorns","fontFamily":"Charcoal, sans-serif","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","text":"Number Of Unicorns","fontFamily":"Charcoal, sans-serif","enabled":true}}}},"background":{"fill":"rgb(255, 255, 255)"},"legend":{"item":{"marker":{"strokeWidth":0},"label":{"fontSize":10,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"}},"position":"right"}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["ag-Grid-AutoColumn","pivot_industry_Artificial intelligence_num_unicorns","pivot_industry_Consumer & retail_num_unicorns","pivot_industry_Cybersecurity_num_unicorns","pivot_industry_Data management & analytics_num_unicorns","pivot_industry_Edtech_num_unicorns","pivot_industry_Fintech_num_unicorns","pivot_industry_Hardware_num_unicorns","pivot_industry_Health_num_unicorns","pivot_industry_Internet software & services_num_unicorns","pivot_industry_Supply chain, logistics, & delivery_num_unicorns"]},"switchCategorySeries":false,"suppressChartRanges":true,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":[],"switchCategorySeries":false},"pivotMode":{"enabled":true,"config":{"rowGroup":{"groupColIds":["year"]},"pivot":{"pivotColIds":["industry"]},"aggregation":{"aggregationModel":[{"aggFunc":"sum","id":"cf761983-0dec-477e-8519-41842fdcf95d","colId":"num_unicorns"}]}}},"activeTab":"format","sharedChartOptions":{"title":{"text":"Year-over-Year Growth in Unicorn Creation by Top 10  Industries [2019-2022]","color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","enabled":true},"series":{"marker":{"enabled":false,"size":5,"shape":"cross"},"strokeWidth":3,"strokeOpacity":1,"label":{"enabled":false}},"axes":{"grouped-category":{"bottom":{"label":{"padding":15,"rotation":0,"autoRotate":false,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}},"top":{"label":{"padding":15,"rotation":0,"autoRotate":false,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}}},"number":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","text":"Number Of Unicorns","fontFamily":"Charcoal, sans-serif","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","text":"Number Of Unicorns","fontFamily":"Charcoal, sans-serif","enabled":true}}}},"background":{"fill":"rgb(255, 255, 255)"},"legend":{"item":{"marker":{"strokeWidth":0},"label":{"fontSize":10,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"}},"position":"right"}},"isToolPanelOpen":false}}},"version":"ag-charts-v1","executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null},"cell_type":"code","id":"559e604c-fcc4-43f5-88b6-b41d2d6bbc05","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"industry":["Artificial intelligence","Artificial intelligence","Artificial intelligence","Consumer & retail","Consumer & retail","Consumer & retail","Cybersecurity","Cybersecurity","Cybersecurity","Data management & analytics","Data management & analytics","Data management & analytics","Edtech","Edtech","Edtech","Fintech","Fintech","Fintech","Hardware","Hardware","Health","Health","Health","Internet software & services","Internet software & services","Internet software & services","Supply chain, logistics, & delivery","Supply chain, logistics, & delivery","Supply chain, logistics, & delivery"],"year":[2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021,2020,2021,2019,2020,2021,2019,2020,2021,2019,2020,2021],"num_unicorns":[14,3,36,3,1,7,4,7,27,4,6,21,1,4,12,20,15,138,1,14,3,9,40,13,20,119,8,2,25]}},"total_rows":29,"truncation_type":null},"text/plain":"                               industry  year  num_unicorns\n0               Artificial intelligence  2019            14\n1               Artificial intelligence  2020             3\n2               Artificial intelligence  2021            36\n3                     Consumer & retail  2019             3\n4                     Consumer & retail  2020             1\n5                     Consumer & retail  2021             7\n6                         Cybersecurity  2019             4\n7                         Cybersecurity  2020             7\n8                         Cybersecurity  2021            27\n9           Data management & analytics  2019             4\n10          Data management & analytics  2020             6\n11          Data management & analytics  2021            21\n12                               Edtech  2019             1\n13                               Edtech  2020             4\n14                               Edtech  2021            12\n15                              Fintech  2019            20\n16                              Fintech  2020            15\n17                              Fintech  2021           138\n18                             Hardware  2020             1\n19                             Hardware  2021            14\n20                               Health  2019             3\n21                               Health  2020             9\n22                               Health  2021            40\n23         Internet software & services  2019            13\n24         Internet software & services  2020            20\n25         Internet software & services  2021           119\n26  Supply chain, logistics, & delivery  2019             8\n27  Supply chain, logistics, & delivery  2020             2\n28  Supply chain, logistics, & delivery  2021            25","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>year</th>\n      <th>num_unicorns</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Artificial intelligence</td>\n      <td>2019</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Artificial intelligence</td>\n      <td>2020</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Artificial intelligence</td>\n      <td>2021</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Consumer &amp; retail</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Consumer &amp; retail</td>\n      <td>2020</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Consumer &amp; retail</td>\n      <td>2021</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Cybersecurity</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Cybersecurity</td>\n      <td>2020</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Cybersecurity</td>\n      <td>2021</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Data management &amp; analytics</td>\n      <td>2019</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Data management &amp; analytics</td>\n      <td>2020</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Data management &amp; analytics</td>\n      <td>2021</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Edtech</td>\n      <td>2019</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Edtech</td>\n      <td>2020</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Edtech</td>\n      <td>2021</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Fintech</td>\n      <td>2019</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Fintech</td>\n      <td>2020</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Fintech</td>\n      <td>2021</td>\n      <td>138</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Hardware</td>\n      <td>2020</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Hardware</td>\n      <td>2021</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Health</td>\n      <td>2019</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Health</td>\n      <td>2020</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Health</td>\n      <td>2021</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Internet software &amp; services</td>\n      <td>2019</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Internet software &amp; services</td>\n      <td>2020</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Internet software &amp; services</td>\n      <td>2021</td>\n      <td>119</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2019</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2020</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>2021</td>\n      <td>25</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":71}],"execution_count":71},{"source":"# **Valuation Concentration and Industry Risk**","metadata":{},"cell_type":"markdown","id":"45b8f02e-967f-43d2-b847-2ecfbc64e0b0"},{"source":"-- Compare average and median valuations to assess valuation concentration within industries\n\nSELECT\n    i.industry,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation / 1000000000)::NUMERIC, 2) AS avg_valuation,\n    ROUND(\n        PERCENTILE_CONT(0.5) \n        WITHIN GROUP (ORDER BY f.valuation / 1000000000)::NUMERIC, \n        2\n    ) AS median_valuation\nFROM funding f\nJOIN industries i USING(company_id)\nGROUP BY i.industry\nORDER BY avg_valuation;","metadata":{"customType":"sql","dataFrameVariableName":"avg_median_valuation","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":null,"lastExecutedAt":null,"lastExecutedByKernel":null,"lastScheduledRunId":null,"lastSuccessfullyExecutedCode":null,"outputsMetadata":{"0":{"height":519,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"}},"chartState":{"chartModel":{"modelType":"range","chartId":"id-iobujzwy7ui","chartType":"line","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["industry","avg_valuation","median_valuation"]},"switchCategorySeries":false,"suppressChartRanges":false,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":["industry","avg_valuation","median_valuation"],"switchCategorySeries":false},"activeTab":"data","customFilter":{"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","const":{"type":"boolean","valid":true,"value":true},"nodeType":"const"}}}},"visualizeDataframe":false,"version":"ag-charts-v1"},"cell_type":"code","id":"ad465d60-88ec-4b89-8412-fc4331677d45","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"num_unicorns","type":"integer"},{"name":"avg_valuation","type":"number"},{"name":"median_valuation","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"industry":["Mobile & telecommunications","Cybersecurity","Health","Internet software & services","Hardware","Supply chain, logistics, & delivery","Auto & transportation","Travel","Data management & analytics","Edtech","E-commerce & direct-to-consumer","Fintech","Consumer & retail","Other","Artificial intelligence"],"num_unicorns":[38,50,74,205,34,57,31,14,41,28,111,224,25,58,84],"avg_valuation":[2.34,2.58,2.68,2.9,2.91,3.11,3.19,3.29,3.32,3.57,3.84,3.94,4.24,4.34,4.49],"median_valuation":[1.5,2,2,2,2,1,2,2,2,2,2,2,2,2,2]}},"total_rows":15,"truncation_type":null},"text/plain":"                               industry  ...  median_valuation\n0           Mobile & telecommunications  ...               1.5\n1                         Cybersecurity  ...               2.0\n2                                Health  ...               2.0\n3          Internet software & services  ...               2.0\n4                              Hardware  ...               2.0\n5   Supply chain, logistics, & delivery  ...               1.0\n6                 Auto & transportation  ...               2.0\n7                                Travel  ...               2.0\n8           Data management & analytics  ...               2.0\n9                                Edtech  ...               2.0\n10      E-commerce & direct-to-consumer  ...               2.0\n11                              Fintech  ...               2.0\n12                    Consumer & retail  ...               2.0\n13                                Other  ...               2.0\n14              Artificial intelligence  ...               2.0\n\n[15 rows x 4 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>num_unicorns</th>\n      <th>avg_valuation</th>\n      <th>median_valuation</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>38</td>\n      <td>2.34</td>\n      <td>1.5</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Cybersecurity</td>\n      <td>50</td>\n      <td>2.58</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Health</td>\n      <td>74</td>\n      <td>2.68</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Internet software &amp; services</td>\n      <td>205</td>\n      <td>2.90</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Hardware</td>\n      <td>34</td>\n      <td>2.91</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>57</td>\n      <td>3.11</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Auto &amp; transportation</td>\n      <td>31</td>\n      <td>3.19</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Travel</td>\n      <td>14</td>\n      <td>3.29</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Data management &amp; analytics</td>\n      <td>41</td>\n      <td>3.32</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Edtech</td>\n      <td>28</td>\n      <td>3.57</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>111</td>\n      <td>3.84</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Fintech</td>\n      <td>224</td>\n      <td>3.94</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Consumer &amp; retail</td>\n      <td>25</td>\n      <td>4.24</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Other</td>\n      <td>58</td>\n      <td>4.34</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Artificial intelligence</td>\n      <td>84</td>\n      <td>4.49</td>\n      <td>2.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":72,"@datacamp/metadata":{"executedQuery":"-- Compare average and median valuations to assess valuation concentration within industries\n\nSELECT\n    i.industry,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation / 1000000000)::NUMERIC, 2) AS avg_valuation,\n    ROUND(\n        PERCENTILE_CONT(0.5) \n        WITHIN GROUP (ORDER BY f.valuation / 1000000000)::NUMERIC, \n        2\n    ) AS median_valuation\nFROM funding f\nJOIN industries i USING(company_id)\nGROUP BY i.industry\nORDER BY avg_valuation;","executedQueryParameters":[]}}],"execution_count":72},{"source":"-- Measure how much of an industry's total valuation is controlled by the top 10% of companies\n\nWITH ranked_valuations AS (\n    SELECT\n        i.industry,\n        f.valuation,\n        NTILE(10) OVER (PARTITION BY i.industry ORDER BY f.valuation DESC) AS valuation_decile\n    FROM industries i\n    JOIN funding f USING(company_id)\n),\n\t\nindustry_totals AS (\n    SELECT\n        industry,\n        SUM(valuation) AS total_valuation\n    FROM ranked_valuations\n    GROUP BY industry\n)\nSELECT\n    r.industry,\n    ROUND(\n        SUM(CASE WHEN valuation_decile = 1 THEN valuation ELSE 0 END)\n        / t.total_valuation * 100,\n        2\n    ) AS top_10_percent_valuation_share\nFROM ranked_valuations r\nJOIN industry_totals t USING(industry)\nGROUP BY r.industry, t.total_valuation\nORDER BY top_10_percent_valuation_share DESC;","metadata":{"customType":"sql","dataFrameVariableName":"top_10_percent_valuation_share","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1118,"lastExecutedAt":1767706456041,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- Measure how much of an industry's total valuation is controlled by the top 10% of companies\n\nWITH ranked_valuations AS (\n    SELECT\n        i.industry,\n        f.valuation,\n        NTILE(10) OVER (PARTITION BY i.industry ORDER BY f.valuation DESC) AS valuation_decile\n    FROM industries i\n    JOIN funding f USING(company_id)\n),\n\t\nindustry_totals AS (\n    SELECT\n        industry,\n        SUM(valuation) AS total_valuation\n    FROM ranked_valuations\n    GROUP BY industry\n)\nSELECT\n    r.industry,\n    ROUND(\n        SUM(CASE WHEN valuation_decile = 1 THEN valuation ELSE 0 END)\n        / t.total_valuation * 100,\n        2\n    ) AS top_10_percent_valuation_share\nFROM ranked_valuations r\nJOIN industry_totals t USING(industry)\nGROUP BY r.industry, t.total_valuation\nORDER BY top_10_percent_valuation_share DESC;","outputsMetadata":{"0":{"height":50,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"}}}}},"cell_type":"code","id":"ace99d8d-7f7c-42f6-842c-46787baf4f26","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"industry","type":"string"},{"name":"top_10_percent_valuation_share","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"industry":["Other","Artificial intelligence","Consumer & retail","E-commerce & direct-to-consumer","Supply chain, logistics, & delivery","Fintech","Edtech","Data management & analytics","Travel","Internet software & services","Auto & transportation","Hardware","Health","Cybersecurity","Mobile & telecommunications"],"top_10_percent_valuation_share":[65.48,64.99,60.38,55.63,53.11,50,49,47.79,41.3,38.99,38.38,36.36,33.33,31.78,31.46]}},"total_rows":15,"truncation_type":null},"text/plain":"                               industry  top_10_percent_valuation_share\n0                                 Other                           65.48\n1               Artificial intelligence                           64.99\n2                     Consumer & retail                           60.38\n3       E-commerce & direct-to-consumer                           55.63\n4   Supply chain, logistics, & delivery                           53.11\n5                               Fintech                           50.00\n6                                Edtech                           49.00\n7           Data management & analytics                           47.79\n8                                Travel                           41.30\n9          Internet software & services                           38.99\n10                Auto & transportation                           38.38\n11                             Hardware                           36.36\n12                               Health                           33.33\n13                        Cybersecurity                           31.78\n14          Mobile & telecommunications                           31.46","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>industry</th>\n      <th>top_10_percent_valuation_share</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Other</td>\n      <td>65.48</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Artificial intelligence</td>\n      <td>64.99</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Consumer &amp; retail</td>\n      <td>60.38</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>E-commerce &amp; direct-to-consumer</td>\n      <td>55.63</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Supply chain, logistics, &amp; delivery</td>\n      <td>53.11</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Fintech</td>\n      <td>50.00</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Edtech</td>\n      <td>49.00</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Data management &amp; analytics</td>\n      <td>47.79</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Travel</td>\n      <td>41.30</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Internet software &amp; services</td>\n      <td>38.99</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Auto &amp; transportation</td>\n      <td>38.38</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Hardware</td>\n      <td>36.36</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Health</td>\n      <td>33.33</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Cybersecurity</td>\n      <td>31.78</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Mobile &amp; telecommunications</td>\n      <td>31.46</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":73,"@datacamp/metadata":{"executedQuery":"-- Measure how much of an industry's total valuation is controlled by the top 10% of companies\n\nWITH ranked_valuations AS (\n    SELECT\n        i.industry,\n        f.valuation,\n        NTILE(10) OVER (PARTITION BY i.industry ORDER BY f.valuation DESC) AS valuation_decile\n    FROM industries i\n    JOIN funding f USING(company_id)\n),\n\t\nindustry_totals AS (\n    SELECT\n        industry,\n        SUM(valuation) AS total_valuation\n    FROM ranked_valuations\n    GROUP BY industry\n)\nSELECT\n    r.industry,\n    ROUND(\n        SUM(CASE WHEN valuation_decile = 1 THEN valuation ELSE 0 END)\n        / t.total_valuation * 100,\n        2\n    ) AS top_10_percent_valuation_share\nFROM ranked_valuations r\nJOIN industry_totals t USING(industry)\nGROUP BY r.industry, t.total_valuation\nORDER BY top_10_percent_valuation_share DESC;","executedQueryParameters":[]}}],"execution_count":73},{"source":"# **Valuation Stability and Market Volatility**","metadata":{},"cell_type":"markdown","id":"f28ab0bf-6e70-4e4b-863e-66278d915197"},{"source":"-- Track changes in average valuation and dispersion to assess market stability over time\n-- Use coefficient of variation to normalize valuation volatility across years\n\nSELECT \n    EXTRACT(YEAR FROM d.date_joined) AS year,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation) / 1000000000, 2) AS avg_valuation_billions,\n    ROUND(STDDEV(f.valuation) / 1000000000, 2) AS stddev_valuation_billions,\n\tROUND(STDDEV(f.valuation) / AVG(f.valuation), 2) AS valuation_volatility_ratio\n\nFROM dates d\nJOIN funding f USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY year\nORDER BY year;","metadata":{"customType":"sql","dataFrameVariableName":"avg_stddev_valuation_ratio","sqlCellMode":"dataFrame","sqlSource":{"integrationId":"89e17161-a224-4a8a-846b-0adc0fe7a4b1","type":"integration"},"executionCancelledAt":null,"executionTime":1363,"lastExecutedAt":1767706457404,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":"-- Track changes in average valuation and dispersion to assess market stability over time\n-- Use coefficient of variation to normalize valuation volatility across years\n\nSELECT \n    EXTRACT(YEAR FROM d.date_joined) AS year,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation) / 1000000000, 2) AS avg_valuation_billions,\n    ROUND(STDDEV(f.valuation) / 1000000000, 2) AS stddev_valuation_billions,\n\tROUND(STDDEV(f.valuation) / AVG(f.valuation), 2) AS valuation_volatility_ratio\n\nFROM dates d\nJOIN funding f USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY year\nORDER BY year;","outputsMetadata":{"0":{"height":50,"type":"dataFrame","tableState":{"customFilter":{"const":{"type":"boolean","valid":true,"value":true},"id":"794efe37-8caf-4369-a86e-f36f3b9f9e8e","nodeType":"const"}},"chartState":{"chartModel":{"modelType":"range","chartId":"id-ljmp2wlhrp","chartType":"groupedColumn","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":[]},"switchCategorySeries":false,"suppressChartRanges":false,"unlinkChart":false,"version":"32.2.2"},"rangeChartModel":{"rangeColumns":[],"switchCategorySeries":false}}}},"visualizeDataframe":false,"version":"ag-charts-v1"},"cell_type":"code","id":"7a0b0395-c131-46f3-810f-f896c5f0f7c9","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"},{"name":"avg_valuation_billions","type":"number"},{"name":"stddev_valuation_billions","type":"number"},{"name":"valuation_volatility_ratio","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2],"year":[2019,2020,2021],"num_unicorns":[104,108,520],"avg_valuation_billions":[4.39,3.72,2.29],"stddev_valuation_billions":[6.12,2.99,2.44],"valuation_volatility_ratio":[1.39,0.8,1.07]}},"total_rows":3,"truncation_type":null},"text/plain":"   year  num_unicorns  ...  stddev_valuation_billions  valuation_volatility_ratio\n0  2019           104  ...                       6.12                        1.39\n1  2020           108  ...                       2.99                        0.80\n2  2021           520  ...                       2.44                        1.07\n\n[3 rows x 5 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>year</th>\n      <th>num_unicorns</th>\n      <th>avg_valuation_billions</th>\n      <th>stddev_valuation_billions</th>\n      <th>valuation_volatility_ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2019</td>\n      <td>104</td>\n      <td>4.39</td>\n      <td>6.12</td>\n      <td>1.39</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2020</td>\n      <td>108</td>\n      <td>3.72</td>\n      <td>2.99</td>\n      <td>0.80</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2021</td>\n      <td>520</td>\n      <td>2.29</td>\n      <td>2.44</td>\n      <td>1.07</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":74,"@datacamp/metadata":{"executedQuery":"-- Track changes in average valuation and dispersion to assess market stability over time\n-- Use coefficient of variation to normalize valuation volatility across years\n\nSELECT \n    EXTRACT(YEAR FROM d.date_joined) AS year,\n    COUNT(*) AS num_unicorns,\n    ROUND(AVG(f.valuation) / 1000000000, 2) AS avg_valuation_billions,\n    ROUND(STDDEV(f.valuation) / 1000000000, 2) AS stddev_valuation_billions,\n\tROUND(STDDEV(f.valuation) / AVG(f.valuation), 2) AS valuation_volatility_ratio\n\nFROM dates d\nJOIN funding f USING(company_id)\nWHERE EXTRACT(YEAR FROM d.date_joined) IN (2019, 2020, 2021)\nGROUP BY year\nORDER BY year;","executedQueryParameters":[]}}],"execution_count":74},{"source":"","metadata":{"customType":"visualization","dataFrameVariableName":"avg_stddev_valuation_ratio","outputsMetadata":{"0":{"height":500,"type":"dataFrame","chartState":{"chartModel":{"modelType":"range","chartId":"id-m31xnn1r0q","chartType":"customCombo","chartThemeName":"datalabTheme","chartOptions":{"common":{"animation":{"enabled":true},"title":{"text":"Unicorn Valuation Volatility Over Time [2019 - 2022]","color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","enabled":true},"axes":{"number":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}}},"category":{"bottom":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}},"top":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}}}},"legend":{"item":{"label":{"fontSize":10,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"}},"position":"right"},"background":{"fill":"rgb(255, 255, 255)"}},"line":{"title":{"text":"Unicorn Valuation Volatility Over Time [2019 - 2022]","color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","enabled":true},"axes":{"number":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}}},"category":{"bottom":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}},"top":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}}}},"series":{"marker":{"enabled":false},"label":{"enabled":false}},"legend":{"item":{"label":{"fontSize":10,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"}},"position":"right"},"background":{"fill":"rgb(255, 255, 255)"},"animation":{"enabled":true}},"bar":{"title":{"text":"Unicorn Valuation Volatility Over Time [2019 - 2022]","color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","enabled":true},"axes":{"number":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}}},"category":{"bottom":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}},"top":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}}}},"legend":{"item":{"label":{"fontSize":10,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"}},"position":"right"},"background":{"fill":"rgb(255, 255, 255)"},"animation":{"enabled":true}},"area":{"title":{"text":"Unicorn Valuation Volatility Over Time [2019 - 2022]","color":"rgb(0, 0, 0)","fontSize":20,"fontStyle":"normal","fontWeight":"bold","fontFamily":"Charcoal, sans-serif","enabled":true},"axes":{"number":{"left":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}},"right":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"fontStyle":"normal","fontWeight":"normal","color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif","text":"Valuation Volatility Ratio","enabled":true}}},"category":{"bottom":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}},"top":{"label":{"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"},"tick":{"stroke":"rgb(0, 0, 0)"},"gridLine":{"style":[{"lineDash":[2,4],"stroke":"rgb(0, 0, 0)"}]},"line":{"stroke":"rgb(0, 0, 0)"},"title":{"color":"rgb(0, 0, 0)","fontStyle":"normal","fontWeight":"normal","fontFamily":"Charcoal, sans-serif","text":"Years","enabled":true}}}},"legend":{"item":{"label":{"fontSize":10,"color":"rgb(0, 0, 0)","fontFamily":"Charcoal, sans-serif"}},"position":"right"},"background":{"fill":"rgb(255, 255, 255)"},"animation":{"enabled":true}}},"chartPalette":{"fills":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"strokes":["#6568A0","#43D7A4","#4095DB","#FACC5F","#CAE279","#F08083","#5BCDF2","#F099DC","#965858","#7DB64F","#A98954"],"up":{"fill":"#459d55","stroke":"#1e652e"},"down":{"fill":"#ef5452","stroke":"#a82529"},"neutral":{"fill":"#b5b5b5","stroke":"#575757"},"altUp":{"fill":"#5090dc","stroke":"#2b5c95"},"altDown":{"fill":"#ffa03a","stroke":"#cc6f10"},"altNeutral":{"fill":"#b5b5b5","stroke":"#575757"}},"cellRange":{"rowStartIndex":null,"rowStartPinned":null,"rowEndIndex":null,"rowEndPinned":null,"columns":["year__number_category__","avg_valuation_billions","stddev_valuation_billions","valuation_volatility_ratio"]},"switchCategorySeries":false,"suppressChartRanges":false,"unlinkChart":false,"seriesChartTypes":[{"colId":"index","chartType":"line","secondaryAxis":false},{"colId":"year","chartType":"line","secondaryAxis":false},{"colId":"num_unicorns","chartType":"line","secondaryAxis":false},{"colId":"avg_valuation_billions","chartType":"line","secondaryAxis":false},{"colId":"stddev_valuation_billions","chartType":"line","secondaryAxis":false},{"colId":"valuation_volatility_ratio","chartType":"stackedColumn","secondaryAxis":false}],"version":"32.2.2"},"rangeChartModel":{"rangeColumns":["year__number_category__","avg_valuation_billions","stddev_valuation_billions","valuation_volatility_ratio"],"switchCategorySeries":false},"activeTab":"format","isToolPanelOpen":false}}},"version":"ag-charts-v1","executionCancelledAt":null,"executionTime":57,"lastExecutedAt":1767706457461,"lastExecutedByKernel":"24de9314-6ebb-4079-a058-bd0cf24adb62","lastScheduledRunId":null,"lastSuccessfullyExecutedCode":""},"cell_type":"code","id":"5481b893-4650-4f18-b405-fa575db6aceb","outputs":[{"output_type":"execute_result","data":{"application/com.datacamp.data-table.v2+json":{"table":{"schema":{"fields":[{"name":"index","type":"integer"},{"name":"year","type":"integer"},{"name":"num_unicorns","type":"integer"},{"name":"avg_valuation_billions","type":"number"},{"name":"stddev_valuation_billions","type":"number"},{"name":"valuation_volatility_ratio","type":"number"}],"primaryKey":["index"],"pandas_version":"1.4.0"},"data":{"index":[0,1,2],"year":[2019,2020,2021],"num_unicorns":[104,108,520],"avg_valuation_billions":[4.39,3.72,2.29],"stddev_valuation_billions":[6.12,2.99,2.44],"valuation_volatility_ratio":[1.39,0.8,1.07]}},"total_rows":3,"truncation_type":null},"text/plain":"   year  num_unicorns  ...  stddev_valuation_billions  valuation_volatility_ratio\n0  2019           104  ...                       6.12                        1.39\n1  2020           108  ...                       2.99                        0.80\n2  2021           520  ...                       2.44                        1.07\n\n[3 rows x 5 columns]","text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>year</th>\n      <th>num_unicorns</th>\n      <th>avg_valuation_billions</th>\n      <th>stddev_valuation_billions</th>\n      <th>valuation_volatility_ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2019</td>\n      <td>104</td>\n      <td>4.39</td>\n      <td>6.12</td>\n      <td>1.39</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2020</td>\n      <td>108</td>\n      <td>3.72</td>\n      <td>2.99</td>\n      <td>0.80</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2021</td>\n      <td>520</td>\n      <td>2.29</td>\n      <td>2.44</td>\n      <td>1.07</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{"application/com.datacamp.data-table.v2+json":{"status":"success"}},"execution_count":75}],"execution_count":75}],"metadata":{"colab":{"name":"Welcome to DataCamp Workspaces.ipynb","provenance":[]},"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.10"}},"nbformat":4,"nbformat_minor":5}